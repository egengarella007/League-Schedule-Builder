(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{67:function(){},2061:function(){},5979:function(e,t,a){Promise.resolve().then(a.bind(a,1209))},1209:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var s=a(7437),r=a(2265),l=a(1541),n=a(8957),o=a(9409),i=a(8203),c=a(6637),d=a(9224),m=a(3523),u=a(3008),g=a(2104),x=a(7504),h=a(7440);let p=null,f="00000000-0000-0000-0000-000000000001",getSupabaseClient=()=>{if(p)return p;try{let e="https://zcoupiuradompbrsebdp.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpjb3VwaXVyYWRvbXBicnNlYmRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzQ3OTMsImV4cCI6MjA3MjIxMDc5M30.OaveieA8KkcWyMZr-H-0xwO6A38zjpGaFIJp3okfZlI";if(console.log("\uD83D\uDD27 Initializing Supabase client with URL:",e),e&&t)return p=(0,h.eI)(e,t,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"Content-Type":"application/json",Accept:"application/json"}}}),console.log("✅ Supabase client initialized successfully"),p;console.error("❌ Missing Supabase URL or API key")}catch(e){console.error("❌ Error initializing Supabase client:",e)}return null};function ImportTab(e){let{uploadedFile:t,setUploadedFile:a,slots:n,setSlots:o,emlThresholds:i}=e,[h,p]=(0,r.useState)(!1),[y,b]=(0,r.useState)(null),[v,D]=(0,r.useState)(n),[j,N]=(0,r.useState)([]),[w,S]=(0,r.useState)(!1);console.log("\uD83D\uDD0D ImportTab received emlThresholds:",i),console.log("\uD83D\uDD0D emlThresholds.earlyStart:",null==i?void 0:i.earlyStart),console.log("\uD83D\uDD0D emlThresholds.midStart:",null==i?void 0:i.midStart),(0,r.useEffect)(()=>{if(console.log("\uD83D\uDE80 ImportTab mounted, checking if CSV data exists..."),console.log("\uD83D\uDD0D Current excelData length:",v.length),console.log("\uD83D\uDD0D Current slots prop length:",n.length),n.length>0){console.log("\uD83D\uDCCA Using slots data from props:",n.length,"slots"),D(n),N(["Type","Event Start","Event End","Resource"]),a(null);return}0===v.length?(console.log("\uD83D\uDCCA No CSV data found, loading from Supabase..."),loadFromSupabase()):console.log("\uD83D\uDCCA CSV data already exists, skipping Supabase load")},[n.length,v.length]);let loadFromSupabase=async()=>{if(console.log("\uD83D\uDD04 Loading data from Supabase..."),!getSupabaseClient()){console.log("❌ Supabase not available"),console.warn("Supabase client not available during data load");return}try{let{data:e,error:t}=await getSupabaseClient().from("slots").select("*").eq("league_id",f).order("event_start");if(t){console.error("❌ Error loading slots:",t),b("Failed to load slots from database");return}if(e&&e.length>0){console.log("✅ Loaded",e.length,"slots from Supabase"),console.log("\uD83D\uDD0D Processing slotsData:",e.length,"slots"),console.log("\uD83D\uDD0D First slot example:",e[0]);let t=e.map(e=>{let t="",a="",s="";try{let s=new Date(e.event_start);if(!isNaN(s.getTime())){let e=new Date(s.getTime()+6e4*s.getTimezoneOffset()),r=(e.getMonth()+1).toString().padStart(2,"0"),l=e.getDate().toString().padStart(2,"0"),n=e.getFullYear().toString().slice(-2);t="".concat(r,"/").concat(l,"/").concat(n);let o=e.getHours(),i=e.getMinutes().toString().padStart(2,"0");a="".concat(o%12||12,":").concat(i," ").concat(o>=12?"PM":"AM")}}catch(e){console.error("Error parsing event_start:",e)}try{let t=new Date(e.event_end);if(!isNaN(t.getTime())){let e=new Date(t.getTime()+6e4*t.getTimezoneOffset()),a=e.getHours(),r=e.getMinutes().toString().padStart(2,"0");s="".concat(a%12||12,":").concat(r," ").concat(a>=12?"PM":"AM")}}catch(e){console.error("Error parsing event_end:",e)}return[t,a,s,e.resource]}),s=t.sort((e,t)=>{let a=e[0],s=t[0],r=e[1],l=t[1],parseDate=e=>{if(!e||"string"!=typeof e)return new Date(0);let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return new Date(0)},parseTime=e=>{if(!e||"string"!=typeof e)return 0;let t=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!t)return 0;let a=parseInt(t[1]),s=parseInt(t[2]),r=t[3];return"PM"===r&&12!==a&&(a+=12),"AM"===r&&12===a&&(a=0),60*a+s},n=parseDate(a),o=parseDate(s);if(n.getTime()!==o.getTime())return n.getTime()-o.getTime();let i=parseTime(r),c=parseTime(l);return i-c});D(s),o(s),a(null),N(["Type","Event Start","Event End","Resource"]),b(null),console.log("✅ Data loaded from Supabase successfully - UI updated"),console.log("\uD83D\uDCCA Current data count:",t.length,"rows")}else console.log("⚠️ No slots found in Supabase"),showNoDataMessage()}catch(e){console.error("❌ Error loading from Supabase:",e),b("Failed to load data from database")}},showNoDataMessage=()=>{D([]),o([]),a(null),N([]),b("No current data. Please upload a file to get started.")},saveToSupabase=async(e,t,a)=>{if(!getSupabaseClient()){console.log("❌ Supabase not available"),b("Database connection not available");return}try{console.log("\uD83D\uDDD1️ Clearing ALL existing data from Supabase...");let{error:e}=await getSupabaseClient().from("slots").delete().eq("league_id",f);if(e)throw Error("Failed to delete existing slots: ".concat(e.message));console.log("✅ Cleared ALL existing data"),console.log("\uD83D\uDCCA Sorting",t.length,"slots by date and time...");let a=[...t].sort((e,t)=>{let parseDateForSort=e=>{if(!e)return new Date(0);let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return new Date(e)},parseTimeForSort=e=>{if(!e)return 0;let t=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!t)return 0;let a=parseInt(t[1]),s=parseInt(t[2]),r=t[3];return"PM"===r&&12!==a&&(a+=12),"AM"===r&&12===a&&(a=0),60*a+s},a=parseDateForSort(e[0]||""),s=parseDateForSort(t[0]||"");if(a.getTime()!==s.getTime())return a.getTime()-s.getTime();let r=parseTimeForSort(e[1]||""),l=parseTimeForSort(t[1]||"");return r-l});console.log("\uD83D\uDCCA Converting and inserting",a.length,"sorted slots...");let s=a.map((e,t)=>{let a=e[0]||"",s=e[1]||"",r=e[2]||"",l=e[3]||"",parseDate=e=>{if(!e)return null;let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=parseInt(t[2]);return new Date(s<100?2e3+s:s,e,a)}return null},parseDateTime=(e,t)=>{let a=parseDate(e);if(!a||!t)return null;let s=t.match(/(\d+):(\d+)\s*(AM|PM)/);if(!s)return null;let r=parseInt(s[1]),l=parseInt(s[2]),n=s[3];"PM"===n&&12!==r&&(r+=12),"AM"===n&&12===r&&(r=0);let o=new Date(a.getFullYear(),a.getMonth(),a.getDate(),r,l,0,0),i=new Date(o.getTime()-6e4*o.getTimezoneOffset());return i.toISOString()},n=parseDateTime(a,s),o=parseDateTime(a,r);return{league_id:f,type:"game",event_start:n,event_end:o,resource:l}}).filter(e=>e.event_start&&e.event_end);console.log("\uD83D\uDCCA Inserting",s.length,"valid slots...");let{error:r}=await getSupabaseClient().from("slots").insert(s);if(r)throw Error("Failed to insert slots: ".concat(r.message));console.log("✅ Successfully saved",s.length,"slots to Supabase"),await loadFromSupabase()}catch(e){console.error("❌ Error saving to Supabase:",e),b("Failed to save data: ".concat(e instanceof Error?e.message:"Unknown error"))}},handleFileUpload=async e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){console.log("File selected:",s.name),p(!0),b(null),a(s);try{let e=await readExcelFile(s);if(console.log("Raw Excel data:",e),0===e.length)throw Error("Excel file is empty");let t=e[0],a=e.slice(1),r=["Event Start","Event End"],l=t.indexOf("Type"),n=t.indexOf("Event Start"),convertExcelDate=e=>{let t;if(console.log("Processing value: ".concat(e," (type: ").concat(typeof e,")")),e instanceof Date)t=e,console.log("Value is already a Date: ".concat(t));else if("number"!=typeof e&&("string"!=typeof e||isNaN(Number(e))))console.log("Trying to parse as date string: ".concat(e)),t=new Date(e),console.log("Parsed date: ".concat(t));else{let a=Number(e);console.log("Converting Excel serial number: ".concat(a)),t=new Date((a-25569)*864e5),console.log("Converted to date: ".concat(t))}if(isNaN(t.getTime()))return console.log("Invalid date, returning original value: ".concat(e)),String(e);let a=t.getHours(),s=t.getMinutes(),r=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),n=t.getFullYear().toString().slice(-2),o=s.toString().padStart(2,"0"),i="".concat(r,"/").concat(l,"/").concat(n," ").concat(a%12||12,":").concat(o," ").concat(a>=12?"PM":"AM");return console.log("Date and time result: ".concat(i)),i},o=a.map(e=>e.map((e,a)=>{let s=t[a];if(a===l){if("number"==typeof e||"string"==typeof e&&!isNaN(Number(e))){let t=new Date((Number(e)-25569)*864e5),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0"),r=t.getFullYear().toString().slice(-2);return"".concat(a,"/").concat(s,"/").concat(r)}return String(e)}return r.includes(s)?convertExcelDate(e):String(e)}));o.sort((e,t)=>{let a=e[l],s=t[l],r=e[n],o=t[n],parseDate=e=>{if(!e||"string"!=typeof e)return new Date(0);let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return new Date(0)},parseTime=e=>{if(!e||"string"!=typeof e)return 0;let t=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!t)return 0;let a=parseInt(t[1]),s=parseInt(t[2]),r=t[3];return"PM"===r&&12!==a&&(a+=12),"AM"===r&&12===a&&(a=0),60*a+s},i=parseDate(a),c=parseDate(s);if(i.getTime()!==c.getTime())return i.getTime()-c.getTime();let d=parseTime(r),m=parseTime(o);return d-m}),await saveToSupabase(s.name,o,t),await loadFromSupabase(),console.log("✅ CSV saved to Supabase, now using Supabase data for display")}catch(e){console.error("Error processing file:",e),b(e instanceof Error?e.message:"Failed to process file")}finally{p(!1)}}},readExcelFile=e=>new Promise((t,a)=>{let s=new FileReader;s.onload=e=>{try{var s;console.log("File read successfully, processing...");let a=new Uint8Array(null===(s=e.target)||void 0===s?void 0:s.result),r=x.read(a,{type:"array"});console.log("Workbook sheets:",r.SheetNames);let l=r.SheetNames[0],n=r.Sheets[l],o=x.utils.sheet_to_json(n,{header:1});console.log("Excel data converted to JSON:",o),t(o)}catch(e){console.error("Error reading Excel file:",e),a(Error("Failed to read Excel file"))}},s.onerror=e=>{console.error("FileReader error:",e),a(Error("Failed to read file"))},s.readAsArrayBuffer(e)});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(l.Z,{className:"w-6 h-6"}),"Import Data"]})}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("button",{onClick:()=>S(!w),className:"w-full flex items-center justify-between text-left",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,s.jsx)(c.Z,{className:"w-5 h-5"}),"Expected File Format"]}),w?(0,s.jsx)(d.Z,{className:"w-5 h-5 text-gray-400"}):(0,s.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"})]}),w&&(0,s.jsxs)("div",{className:"text-sm text-gray-300 space-y-3 mt-4",children:[(0,s.jsx)("p",{children:"Your Excel file should have the following structure:"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full border border-gray-600 rounded",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-700",children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Date"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Event Start"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Event End"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Resource"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"9/6/25"}),(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"9:00 PM"}),(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"10:20 PM"}),(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"GPI - Rink 4"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"9/6/25"}),(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"10:15 PM"}),(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"11:35 PM"}),(0,s.jsx)("td",{className:"px-4 py-2 border-b border-gray-600",children:"GPI - Rink 2"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:"9/9/25"}),(0,s.jsx)("td",{className:"px-4 py-2",children:"9:35 PM"}),(0,s.jsx)("td",{className:"px-4 py-2",children:"10:55 PM"}),(0,s.jsx)("td",{className:"px-4 py-2",children:"GPI - Rink 3"})]})]})]})})]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("label",{className:"cursor-pointer",children:[(0,s.jsx)("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:handleFileUpload,className:"hidden",disabled:h}),(0,s.jsxs)("div",{className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-600 px-6 py-3 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[(0,s.jsx)(l.Z,{className:"w-5 h-5"}),h?"Processing...":"Upload CSV"]})]})}),t&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5"}),(0,s.jsxs)("span",{children:["File uploaded: ",t.name]})]}),y&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-400",children:[(0,s.jsx)(g.Z,{className:"w-5 h-5"}),(0,s.jsxs)("span",{children:["Error loading file: ",y]})]}),0===v.length&&!h&&(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:(0,s.jsxs)("div",{className:"text-gray-400 mb-4",children:[(0,s.jsx)(c.Z,{className:"w-16 h-16 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No Current Data"}),(0,s.jsx)("p",{className:"text-sm",children:"Upload a file to get started with your league scheduling."})]})}),v.length>0&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:v.length}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Total Games"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(()=>{if(0===v.length)return"N/A";let e=v[0][0];if(e&&e.includes("T"))try{let t=new Date(e);return t.toLocaleDateString()}catch(e){return"N/A"}if(e&&"string"==typeof e){let t=e.split("/");if(3===t.length){let e=parseInt(t[0]),a=parseInt(t[1]),s=2e3+parseInt(t[2]);return"".concat(e,"/").concat(a,"/").concat(s)}}return"N/A"})()}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Start Date"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(()=>{if(0===v.length)return"N/A";let e=v[v.length-1][0];if(e&&e.includes("T"))try{let t=new Date(e);return t.toLocaleDateString()}catch(e){return"N/A"}if(e&&"string"==typeof e){let t=e.split("/");if(3===t.length){let e=parseInt(t[0]),a=parseInt(t[1]),s=2e3+parseInt(t[2]);return"".concat(e,"/").concat(a,"/").concat(s)}}return"N/A"})()}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"End Date"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(()=>{if(0===v.length)return"N/A";let e=v[0][0],t=v[v.length-1][0],parseDate=e=>{if(!e||"string"!=typeof e)return null;let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return null},a=parseDate(e),s=parseDate(t);if(a&&s){let e=s.getTime()-a.getTime();return Math.max(1,Math.ceil(Math.ceil(e/864e5)/7))}return a?1:"N/A"})()}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Weeks"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(()=>{let getEMLCategory=e=>{if(!i||!i.earlyStart||!i.midStart)return console.warn("⚠️ emlThresholds not properly initialized:",i),"Unknown";let t=i.earlyStart||"22:01",a=i.midStart||"22:31",s=e.includes(" ")?e.split(" ").slice(-2).join(" "):e;console.log("\uD83D\uDD0D Original timeStr:",e,"Extracted timeOnly:",s);let r=s.match(/(\d+):(\d+)\s*(AM|PM)/);if(!r)return console.warn("⚠️ Failed to parse time:",e,"timeOnly:",s),"Unknown";let l=parseInt(r[1]),n=parseInt(r[2]),o=r[3];"PM"===o&&12!==l&&(l+=12),"AM"===o&&12===l&&(l=0);let c=60*l+n;console.log("\uD83D\uDD0D Converted to 24-hour:",{hours:l,minutes:n,gameMinutes:c});let d=0,m=0,u=t.match(/^(\d{1,2}):(\d{2})$/),g=a.match(/^(\d{1,2}):(\d{2})$/);return u&&g?(console.log("\uD83D\uDD0D EML thresholds (24-hour):",{earlyStart:t,midStart:a,earlyMinutesTotal:d=60*parseInt(u[1])+parseInt(u[2]),midMinutesTotal:m=60*parseInt(g[1])+parseInt(g[2])}),c<d)?"Early":c>=d&&c<m?"Mid":"Late":(console.warn("⚠️ EML thresholds not in expected 24-hour format:",{earlyStart:t,midStart:a}),"Unknown")},e=v.filter(e=>{let t=e[1]||"";return"Early"===getEMLCategory(t)}).length,t=v.filter(e=>{let t=e[1]||"";return"Mid"===getEMLCategory(t)}).length,a=v.filter(e=>{let t=e[1]||"";return"Late"===getEMLCategory(t)}).length;return"".concat(e," / ").concat(t," / ").concat(a)})()}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"E / M / L"})]})]}),(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-700",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"DATE"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"EVENT START"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"EVENT END"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"RESOURCE"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"E/M/L"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-700",children:v.map((e,t)=>{let formatTime=e=>{if(!e)return"N/A";if(e.includes("T"))try{let t=new Date(e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(e){}return e},a=e[1]||"",r=(e=>{if(!i||!i.earlyStart||!i.midStart)return console.warn("⚠️ emlThresholds not properly initialized:",i),"Unknown";let t=i.earlyStart||"22:01",a=i.midStart||"22:31",s=e.includes(" ")?e.split(" ").slice(-2).join(" "):e;console.log("\uD83D\uDD0D Original timeStr:",e,"Extracted timeOnly:",s);let r=s.match(/(\d+):(\d+)\s*(AM|PM)/);if(!r)return console.warn("⚠️ Failed to parse time:",e,"timeOnly:",s),"Unknown";let l=parseInt(r[1]),n=parseInt(r[2]),o=r[3];"PM"===o&&12!==l&&(l+=12),"AM"===o&&12===l&&(l=0);let c=60*l+n;console.log("\uD83D\uDD0D Converted to 24-hour:",{hours:l,minutes:n,gameMinutes:c});let d=0,m=0,u=t.match(/^(\d{1,2}):(\d{2})$/),g=a.match(/^(\d{1,2}):(\d{2})$/);return u&&g?(console.log("\uD83D\uDD0D EML thresholds (24-hour):",{earlyStart:t,midStart:a,earlyMinutesTotal:d=60*parseInt(u[1])+parseInt(u[2]),midMinutesTotal:m=60*parseInt(g[1])+parseInt(g[2])}),c<d)?"Early":c>=d&&c<m?"Mid":"Late":(console.warn("⚠️ EML thresholds not in expected 24-hour format:",{earlyStart:t,midStart:a}),"Unknown")})(a);return(0,s.jsxs)("tr",{className:"hover:bg-gray-700",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(e=>{if(!e)return"N/A";if(e.includes("T"))try{let t=new Date(e);return t.toLocaleDateString()}catch(t){return e}if("string"==typeof e){let t=e.split("/");if(3===t.length){let e=parseInt(t[0]),a=parseInt(t[1]),s=2e3+parseInt(t[2]);return"".concat(e,"/").concat(a,"/").concat(s)}}return e})(e[0])}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:formatTime(e[1])}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:formatTime(e[2])}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e[3]||""}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("Early"===r?"bg-green-600":"Mid"===r?"bg-yellow-600":"bg-red-600"),children:r})})]},t)})})]})})})]})]})}var y=a(2549),b=a(9883),v=a(5750);function TeamsTab(){let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)([]),[o,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[m,u]=(0,r.useState)(""),[g,x]=(0,r.useState)(!1),[h,D]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[w,S]=(0,r.useState)("");(0,r.useEffect)(()=>{loadTeamsFromSupabase()},[]);let loadTeamsFromSupabase=async()=>{if(!p){console.log("❌ Supabase not available"),D("Database connection not available");return}try{console.log("\uD83D\uDD04 Loading divisions and teams from Supabase...");let{data:e,error:a}=await p.from("divisions").select("*").eq("league_id",f).order("name",{ascending:!0});if(a)throw Error("Failed to load divisions: ".concat(a.message));let{data:s,error:r}=await p.from("teams").select("*").eq("league_id",f).order("name",{ascending:!0});if(r)throw Error("Failed to load teams: ".concat(r.message));console.log("✅ Loaded",(null==e?void 0:e.length)||0,"divisions and",(null==s?void 0:s.length)||0,"teams from Supabase"),l(e||[]),t(s||[]),D(null)}catch(e){console.error("❌ Error loading teams:",e),D("Failed to load teams: ".concat(e instanceof Error?e.message:"Unknown error"))}},addTeamToSupabase=async(e,t)=>{if(!p){console.log("❌ Supabase not available"),D("Database connection not available");return}try{let s;console.log("\uD83D\uDCDD Adding team to Supabase:",e,t);let r=a.find(t=>t.name===e);if(r)s=r.id;else{let{data:t,error:a}=await p.from("divisions").insert({league_id:f,name:e}).select().single();if(a)throw Error("Failed to create division: ".concat(a.message));s=t.id}let{data:l,error:n}=await p.from("teams").insert({league_id:f,division_id:s,name:t}).select().single();if(n)throw Error("Failed to add team: ".concat(n.message));console.log("✅ Team added successfully:",l),await loadTeamsFromSupabase(),D(null)}catch(e){console.error("❌ Error adding team:",e),D("Failed to add team: ".concat(e instanceof Error?e.message:"Unknown error"))}},removeTeamFromSupabase=async e=>{if(!p){console.log("❌ Supabase not available"),D("Database connection not available");return}try{console.log("\uD83D\uDDD1️ Removing team from Supabase:",e);let{error:t}=await p.from("teams").delete().eq("id",e);if(t)throw Error("Failed to remove team: ".concat(t.message));console.log("✅ Team removed successfully"),await loadTeamsFromSupabase(),D(null)}catch(e){console.error("❌ Error removing team:",e),D("Failed to remove team: ".concat(e instanceof Error?e.message:"Unknown error"))}},addDivision=()=>{o.trim()&&(addTeamToSupabase(o.trim(),"Team 1"),i(""))},addTeam=e=>{let t=T[e]||[],a=t.map(e=>{let t=e.name.match(/Team (\d+)/);return t?parseInt(t[1]):0}),s=a.length>0?Math.max(...a)+1:1,r="Team ".concat(s);addTeamToSupabase(e,r)},removeTeam=e=>{removeTeamFromSupabase(e)},removeDivision=async e=>{if(!p){console.log("❌ Supabase not available"),D("Database connection not available");return}try{console.log("\uD83D\uDDD1️ Removing division from Supabase:",e);let t=a.find(t=>t.name===e);if(!t)throw Error("Division not found");let{error:s}=await p.from("teams").delete().eq("division_id",t.id);if(s)throw Error("Failed to remove teams: ".concat(s.message));let{error:r}=await p.from("divisions").delete().eq("id",t.id);if(r)throw Error("Failed to remove division: ".concat(r.message));console.log("✅ Division removed successfully"),await loadTeamsFromSupabase(),D(null)}catch(e){console.error("❌ Error removing division:",e),D("Failed to remove division: ".concat(e instanceof Error?e.message:"Unknown error"))}},updateTeamName=async(e,t)=>{if(!p){console.log("❌ Supabase not available"),D("Database connection not available");return}try{console.log("\uD83D\uDCDD Updating team name in Supabase:",e,t);let{error:a}=await p.from("teams").update({name:t}).eq("id",e);if(a)throw Error("Failed to update team name: ".concat(a.message));console.log("✅ Team name updated successfully"),await loadTeamsFromSupabase(),D(null)}catch(e){console.error("❌ Error updating team name:",e),D("Failed to update team name: ".concat(e instanceof Error?e.message:"Unknown error"))}},startEditing=e=>{N(e.id),S(e.name)},saveTeamName=()=>{j&&w.trim()&&(updateTeamName(j,w.trim()),N(null),S(""))},cancelEditing=()=>{N(null),S("")},T=a.reduce((t,a)=>{let s=e.filter(e=>e.division_id===a.id),r=s.sort((e,t)=>{let a=e.name.match(/Team (\d+)/),s=t.name.match(/Team (\d+)/);return a&&s?parseInt(a[1])-parseInt(s[1]):e.name.localeCompare(t.name)});return t[a.name]=r,console.log('\uD83D\uDCCA Division "'.concat(a.name,'": ').concat(r.length," teams"),r.map(e=>e.name)),t},{});return console.log("\uD83D\uDD0D Total teams in state:",e.length),console.log("\uD83D\uDD0D Teams by division:",T),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(n.Z,{className:"w-6 h-6"}),"Teams & Divisions"]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400 mt-2",children:["Total teams: ",e.length," | Total divisions: ",a.length]})]}),h&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-400 bg-red-900/20 border border-red-800 rounded-lg p-4",children:[(0,s.jsx)(y.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:h})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(b.Z,{className:"w-5 h-5"}),"Add Division"]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"Enter division name...",className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500",onKeyPress:e=>"Enter"===e.key&&addDivision()}),(0,s.jsx)("button",{onClick:addDivision,disabled:!o.trim(),className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-600 px-6 py-2 rounded-lg font-medium transition-colors",children:"Add Division"})]})]}),e.length>0?(0,s.jsx)("div",{className:"space-y-4",children:a.map(e=>{var t,a;return(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,s.jsx)(n.Z,{className:"w-5 h-5"}),e.name]}),(0,s.jsx)("button",{onClick:()=>removeDivision(e.name),className:"text-red-400 hover:text-red-300 transition-colors",title:"Remove entire division",children:(0,s.jsx)(y.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-400",children:[(null===(t=T[e.name])||void 0===t?void 0:t.length)||0," team",1!==((null===(a=T[e.name])||void 0===a?void 0:a.length)||0)?"s":""]}),(0,s.jsxs)("button",{onClick:()=>addTeam(e.name),className:"bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm font-medium flex items-center gap-1 transition-colors",children:[(0,s.jsx)(b.Z,{className:"w-3 h-3"}),"Add Team"]})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:(T[e.name]||[]).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-700 rounded-lg px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,s.jsx)(v.Z,{className:"w-4 h-4 text-gray-400"}),j===e.id?(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,s.jsx)("input",{type:"text",value:w,onChange:e=>S(e.target.value),className:"flex-1 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500",onKeyPress:e=>{"Enter"===e.key&&saveTeamName(),"Escape"===e.key&&cancelEditing()},autoFocus:!0}),(0,s.jsx)("button",{onClick:saveTeamName,className:"text-green-400 hover:text-green-300 transition-colors",title:"Save",children:"✓"}),(0,s.jsx)("button",{onClick:cancelEditing,className:"text-gray-400 hover:text-gray-300 transition-colors",title:"Cancel",children:"✕"})]}):(0,s.jsx)("span",{className:"cursor-pointer hover:text-gray-300 transition-colors",onClick:()=>startEditing(e),title:"Click to edit team name",children:e.name})]}),(0,s.jsx)("button",{onClick:()=>removeTeam(e.id),className:"text-red-400 hover:text-red-300 transition-colors ml-2",title:"Remove team",children:(0,s.jsx)(y.Z,{className:"w-4 h-4"})})]},e.id))})]},e.id)})}):(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 text-center",children:[(0,s.jsx)(n.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400",children:"No teams added yet."}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"Add teams above to start building your league structure."})]})]})}var D=a(4280),j=a(2369),N=a(5817);function ScheduleTab(e){var t,l,n,o;let{slots:c,teams:d,divisions:m,params:g}=e,getEMLCategory=e=>{var t,a;let s=(null===(t=g.eml)||void 0===t?void 0:t.earlyStart)||"22:01",r=(null===(a=g.eml)||void 0===a?void 0:a.midStart)||"22:31",l=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!l)return"Unknown";let n=parseInt(l[1]),o=parseInt(l[2]),i=l[3];"PM"===i&&12!==n&&(n+=12),"AM"===i&&12===n&&(n=0);let c=60*n+o,d=0,m=0,u=s.match(/^(\d{1,2}):(\d{2})$/),x=r.match(/^(\d{1,2}):(\d{2})$/);if(u&&x)d=60*parseInt(u[1])+parseInt(u[2]),m=60*parseInt(x[1])+parseInt(x[2]);else{let e=s.match(/(\d+):(\d+)\s*(AM|PM)/),t=r.match(/(\d+):(\d+)\s*(AM|PM)/);if(!e||!t)return"Unknown";let a=parseInt(e[1]),l=parseInt(e[2]),n=e[3],o=parseInt(t[1]),i=parseInt(t[2]),c=t[3];"PM"===n&&12!==a&&(a+=12),"AM"===n&&12===a&&(a=0),"PM"===c&&12!==o&&(o+=12),"AM"===c&&12===o&&(o=0),d=60*a+l,m=60*o+i}return c<d?"Early":c>=d&&c<m?"Mid":"Late"},[x,h]=(0,r.useState)([]),[b,v]=(0,r.useState)([]),[w,S]=(0,r.useState)([]),[T,k]=(0,r.useState)(!1),[C,E]=(0,r.useState)(""),[A,F]=(0,r.useState)(""),[I,M]=(0,r.useState)([]),[P,_]=(0,r.useState)(null),[L,z]=(0,r.useState)(null),[R,O]=(0,r.useState)(!1),[G,U]=(0,r.useState)(!1),[B,Z]=(0,r.useState)(null),[H,W]=(0,r.useState)(2),[V,J]=(0,r.useState)([]),[q,Y]=(0,r.useState)(!1),[$,K]=(0,r.useState)(0),[X,Q]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(!1),[ea,es]=(0,r.useState)(null),[er,el]=(0,r.useState)(!1),[en,eo]=(0,r.useState)(!1),[ei,ec]=(0,r.useState)(!1),[ed,em]=(0,r.useState)(null),eu=(0,r.useRef)(null);(0,r.useEffect)(()=>{loadTeamsAndDivisions(),loadSlots(),loadParams()},[]),(0,r.useEffect)(()=>()=>{eu.current&&(clearTimeout(eu.current),console.log("\uD83C\uDFAF Cleaned up auto-optimization timer on unmount"))},[]),(0,r.useEffect)(()=>{ee&&!G&&H>2&&(console.log("\uD83C\uDFAF Auto-optimization: Starting Week ".concat(H)),et(!1),handleOptimizeSchedule())},[ee,G,H]),(0,r.useEffect)(()=>{I.length>0&&console.log("\uD83D\uDD04 Schedule updated - recalculating team counts:",{scheduleLength:I.length,teamNames:Array.from(new Set([...I.map(e=>e.HomeTeam),...I.map(e=>e.AwayTeam)])),sampleGames:I.slice(0,3)})},[I]);let sortScheduleChronologically=e=>[...e].sort((e,t)=>{let a=new Date("".concat(e.Date," ").concat(e.Start)),s=new Date("".concat(t.Date," ").concat(t.Start));return a.getTime()-s.getTime()}),loadSlots=async()=>{if(p)try{let{data:e,error:t}=await p.from("slots").select("*").eq("league_id",f).order("event_start",{ascending:!0});if(t)throw t;S(e||[]),console.log("Loaded slots:",(null==e?void 0:e.length)||0)}catch(e){console.error("Error loading slots:",e)}},loadParams=async()=>{try{let e=await fetch("/api/parameters");if(e.ok){let t=await e.json();t.success&&t.data&&console.log("✅ Loaded parameters from server:",t.data)}}catch(e){console.error("Error loading parameters:",e)}},handleTeamClick=e=>{z(e),O(!0)},closeTeamSchedule=()=>{O(!1),z(null)},handleOptimizeSchedule=async()=>{if(I.length){console.log("\uD83C\uDFAF handleOptimizeSchedule called for Week ".concat(H)),console.log("\uD83C\uDFAF Current state: currentWeek=".concat(H,", weeksOptimized=").concat(V.join(","),", allWeeksComplete=").concat(q)),U(!0),Z(null),Q(!1);try{console.log("\uD83D\uDD27 Starting optimization with schedule:",I.length,"games"),console.log("\uD83D\uDD27 Using schedule in original order (scheduler already created proper blocks)");let e=Array.from(new Set(I.map(e=>e.Division)));console.log("\uD83D\uDD27 Unique divisions in schedule:",e),console.log("\uD83D\uDD27 Sample games with divisions:"),I.slice(0,10).forEach((e,t)=>{console.log("  ".concat(t+1,'. Div: "').concat(e.Division,'" - ').concat(e.HomeTeam," vs ").concat(e.AwayTeam))});let t=[];for(let e=0;e<I.length;e+=10){let a=I.slice(e,e+10);10===a.length&&t.push(a)}if(console.log("\uD83D\uDD27 Total games:",I.length),console.log("\uD83D\uDD27 Block size:",10),console.log("\uD83D\uDD27 Found complete blocks:",t.length),0===t.length){E("Schedule must have complete blocks of ".concat(10," games for optimization. Found ").concat(I.length," total games.")),U(!1);return}let a=t[0];a.reduce((e,t)=>{var a;let s=null===(a=t.Division)||void 0===a?void 0:a.toLowerCase().trim();return"Tin Super"===s||(null==s?void 0:s.includes("12"))?e["Tin Super"]=(e["Tin Super"]||0)+1:("Tin South"===s||(null==s?void 0:s.includes("8")))&&(e["Tin South"]=(e["Tin South"]||0)+1),e},{}),console.log("\uD83D\uDD27 Processing ALL games for optimization (not just first block)"),console.log("\uD83D\uDD27 Total games to optimize:",I.length);let s=I.map((e,t)=>{let a=new Date(e.Date+" "+e.Start),s=e.End||"22:20",r=new Date(e.Date+" "+s),l="unknown";if(e.Division){let t=e.Division.toLowerCase().trim();l="tin super"===t||t.includes("12")?"Tin Super":"tin south"===t||t.includes("8")?"Tin South":"unknown"}let extractTeamNumber=e=>{let t=e.match(/(\d+)$/);return t?t[1]:e},formatLocalTime=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s,"T").concat(r,":").concat(l,":00.000")};return{id:t+1,start:formatLocalTime(a),end:formatLocalTime(r),rink:e.Rink||"Unknown",div:l,home:extractTeamNumber(e.HomeTeam),away:extractTeamNumber(e.AwayTeam)}});console.log("\uD83D\uDD27 Prepared schedule data:",s.slice(0,3)),console.log("\uD83D\uDD27 Total games to optimize:",s.length),console.log("\uD83D\uDD27 Division counts:",s.reduce((e,t)=>(e[t.div]=(e[t.div]||0)+1,e),{})),console.log("\uD83D\uDD27 Sample game structure:",{sampleGame:s[0],sampleGameKeys:Object.keys(s[0]||{}),sampleGameValues:Object.values(s[0]||{})}),console.log("\uD83D\uDD27 Game order check:"),s.forEach((e,t)=>{console.log("  Game ".concat(t+1,": ").concat(e.start," (ID: ").concat(e.id,") - ").concat(e.home," vs ").concat(e.away," (").concat(e.div,")"))});let r=s.some(e=>"unknown"===e.div);console.log("\uD83D\uDD27 Data validation:",{hasUnknownDiv:r}),console.log("\uD83D\uDD27 Sample games with readable times:"),s.slice(0,10).forEach((e,t)=>{let a=new Date(e.start),s=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});console.log("  Game ".concat(t+1,": ").concat(e.start," → ").concat(s," - ").concat(e.home," vs ").concat(e.away," (").concat(e.div,")"))});let l=s.filter(e=>{let t=new Date(e.start);return t.getHours()>=22&&t.getMinutes()>=31});if(console.log("\uD83D\uDD27 Late games found: ".concat(l.length," out of ").concat(s.length," total games")),l.length>0&&(console.log("\uD83D\uDD27 Late games:"),l.slice(0,5).forEach((e,t)=>{let a=new Date(e.start),s=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});console.log("  Late Game ".concat(t+1,": ").concat(e.start," → ").concat(s," - ").concat(e.home," vs ").concat(e.away," (").concat(e.div,")"))})),r){E("Cannot optimize schedule with unknown divisions. Please check division assignments."),U(!1);return}let n={schedule:s,blockSize:10,blockRecipe:{"Tin Super":6,"Tin South":4},divisionSizes:{"Tin Super":12,"Tin South":8},earlyStart:"10:01 PM",midStart:"10:31 PM",target_week:H,defaultGameMinutes:80,weights:{w_eml:1,w_runs:.2,w_rest:.6},wGlobal:2,wRolling:1.2,wRepeat:1,wDispersion:.6,wLateFairness:1,globalSlack:1,rollingSlack:0,maxPasses:3,dryRun:!1,optimize_days_since:!0,force_full_validation:!0};console.log("\uD83C\uDFAF Auto-optimization API request for Week ".concat(H,":"),n),console.log("\uD83C\uDFAF Ensuring three-phase optimization with full validation...");let o=await fetch("/api/optimize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(console.log("\uD83D\uDD27 API response status:",o.status),!o.ok){let e=await o.text();throw console.error("\uD83D\uDD27 API error response:",e),Error("API error: ".concat(o.status," - ").concat(e))}let i=await o.json();if(console.log("\uD83D\uDD27 Optimization result:",i),console.log("\uD83C\uDFAF API result optimization tracking:",{weeks_optimized:i.weeks_optimized,all_weeks_complete:i.all_weeks_complete,total_optimizable_weeks:i.total_optimizable_weeks}),i.weeks_optimized&&J(i.weeks_optimized),void 0!==i.all_weeks_complete&&Y(i.all_weeks_complete),i.total_optimizable_weeks?(console.log("\uD83C\uDFAF Setting totalOptimizableWeeks to: ".concat(i.total_optimizable_weeks)),K(i.total_optimizable_weeks)):console.log("\uD83C\uDFAF WARNING: No total_optimizable_weeks in API result!"),i.swaps&&i.swaps.length>0){if(Z({improvements:i.swaps.length}),es(i),i.swaps.length===x.length){if(console.log("\uD83C\uDFAF Perfect solution! ".concat(i.swaps.length," changes = ").concat(x.length," teams")),console.log("\uD83C\uDFAF Auto-optimization DISABLED for testing. Week ".concat(H," complete.")),console.log("\uD83C\uDFAF Please manually move to next week to test if this fixes the 0-day gap issue."),i.swaps&&i.swaps.length>0&&(console.log("\uD83C\uDFAF DEBUG: Setting optimization results for manual use: ".concat(i.swaps.length," swaps")),es(i),Z({improvements:i.swaps.length})),i.schedule){console.log("\uD83C\uDFAF Auto-optimization: Updating schedule for Week ".concat(H));let e=i.schedule.map(e=>{var t;let a=(null===(t=e.start)||void 0===t?void 0:t.split("T")[0])||"",s=new Date(e.start),r=new Date(e.end);return{Date:a,Start:s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),End:r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),Rink:e.rink||"Unknown",Division:e.div||"Unknown",HomeTeam:e.home||"Unknown",AwayTeam:e.away||"Unknown"}});M(e),console.log("\uD83C\uDFAF Schedule updated successfully for Week ".concat(H)),console.log("\uD83C\uDFAF Optimization results preserved for manual implementation")}console.log("\uD83C\uDFAF Auto-optimization DISABLED for testing. Week ".concat(H," complete.")),console.log("\uD83C\uDFAF Please manually move to next week to test if this fixes the 0-day gap issue."),i.swaps&&i.swaps.length>0&&(console.log("\uD83C\uDFAF DEBUG: Setting optimization results for manual use: ".concat(i.swaps.length," swaps")),es(i),Z({improvements:i.swaps.length}))}else console.log("\uD83C\uDFAF Week ".concat(H," optimization complete. Waiting for user to implement changes."))}else Z({improvements:0}),console.log("\uD83C\uDFAF Week ".concat(H," optimization complete (no changes). Waiting for user to implement changes."))}catch(e){console.error("❌ Optimization error:",e),E("Optimization failed: "+e.message)}finally{U(!1)}}},loadTeamsAndDivisions=async()=>{if(p)try{let{data:e,error:t}=await p.from("divisions").select("*").eq("league_id",f).order("name",{ascending:!0});if(t)throw t;let{data:a,error:s}=await p.from("teams").select("*").eq("league_id",f).order("name",{ascending:!0});if(s)throw s;let r=(null==a?void 0:a.map(t=>{let a=null==e?void 0:e.find(e=>e.id===t.division_id);return{...t,division:(null==a?void 0:a.name)||"Unknown",divisionId:(null==a?void 0:a.id)||t.division_id}}))||[];v(e||[]),h(r||[]),console.log("Loaded teams:",(null==r?void 0:r.length)||0),console.log("Loaded divisions:",(null==e?void 0:e.length)||0),console.log("Sample team with division:",null==r?void 0:r[0])}catch(e){console.error("Error loading teams and divisions:",e)}},exportToCSV=()=>{if(!I.length)return;let e=["Game #,Date,Start Time,End Time,Rink,Division,Home Team,Away Team",...I.map((e,t)=>[t+1,e.Date,e.Start,e.End||"",e.Rink,e.Division,e.HomeTeam,e.AwayTeam].join(","))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(t);a.setAttribute("href",s),a.setAttribute("download","league-schedule-".concat(new Date().toISOString().split("T")[0],".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},exportToExcel=()=>{if(!I.length)return;let e=I.map((e,t)=>({"Game #":t+1,Date:e.Date,"Start Time":e.Start,"End Time":e.End||"",Rink:e.Rink,Division:e.Division,"Home Team":e.HomeTeam,"Away Team":e.AwayTeam}));Promise.resolve().then(a.bind(a,7504)).then(t=>{let a=t.utils.book_new(),s=t.utils.json_to_sheet(e);s["!cols"]=[{wch:8},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:15},{wch:15}],t.utils.book_append_sheet(a,s,"League Schedule");let r=t.write(a,{bookType:"xlsx",type:"array"}),l=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a"),o=URL.createObjectURL(l);n.setAttribute("href",o),n.setAttribute("download","league-schedule-".concat(new Date().toISOString().split("T")[0],".xlsx")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}).catch(e=>{console.error("Error exporting to Excel:",e),alert("Excel export failed. Falling back to CSV export."),exportToCSV()})},generateSchedule=async()=>{k(!0),E(""),F("");try{console.log("\uD83D\uDD0D DEBUG: Current state before request:"),console.log("  - Slots count:",w.length),console.log("  - Teams count:",x.length),console.log("  - Divisions count:",b.length),console.log("  - Params:",g),console.log("  - Sample slot:",w[0]),console.log("  - Sample team:",x[0]),console.log("Sending request with:",{leagueId:f,slotsCount:w.length,teamsCount:x.length,divisionsCount:b.length,params:g});let a=await fetch("/api/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:f,params:g,slots:w,teams:x,divisions:b})}),s=await a.json();if(!a.ok)throw Error(s.error||"Failed to generate schedule");if(console.log("Schedule generation result:",s),console.log("Schedule data:",s.schedule),s.schedule&&Array.isArray(s.schedule)){var e,t;let a=s.schedule.filter(e=>e&&"object"==typeof e&&e.Date&&e.HomeTeam&&e.AwayTeam);a=sortScheduleChronologically(a),console.log("Valid schedule entries:",a.length),console.log("\uD83D\uDCC5 Schedule sorted chronologically from",null===(e=a[0])||void 0===e?void 0:e.Date,"to",null===(t=a[a.length-1])||void 0===t?void 0:t.Date),M(a);let r=Math.ceil(a.length/10),l=r-1;K(l),console.log("\uD83D\uDCCA Schedule has ".concat(r," weeks, ").concat(l," can be optimized")),J([]),Y(!1),W(2)}else console.log("No valid schedule data received"),M([]),K(0),J([]),Y(!1);F("Schedule generated successfully!")}catch(e){console.error("Schedule generation error:",e),E(e instanceof Error?e.message:"Failed to generate schedule")}finally{k(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(i.Z,{className:"w-6 h-6"}),"Schedule Generation"]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Data Imported"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:w.length}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Available time slots"})]}),(0,s.jsx)(u.Z,{className:"w-8 h-8 text-green-500"})]})}),(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Teams Configured"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-400",children:x.length}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:["Teams across ",b.length," divisions"]})]}),(0,s.jsx)(u.Z,{className:"w-8 h-8 text-green-500"})]})}),(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,s.jsx)("button",{onClick:generateSchedule,disabled:T||0===w.length||0===x.length,className:"w-full h-full bg-green-600 hover:bg-green-700 disabled:bg-gray-600 px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",children:T?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Z,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{className:"w-5 h-5"}),"Generate Schedule"]})})})]}),C&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 text-red-400",children:C}),A&&(0,s.jsx)("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4 text-green-400",children:A}),I.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Game Count Summary"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Games Generated:"}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-green-400",children:[I.length,"/",Math.round(x.length*g.gamesPerTeam/2)]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,s.jsx)("span",{className:"text-sm font-medium px-2 py-1 rounded ".concat(I.length===Math.round(x.length*g.gamesPerTeam/2)?"bg-green-900/20 text-green-400 border border-green-800":"bg-yellow-900/20 text-yellow-400 border border-yellow-800"),children:I.length===Math.round(x.length*g.gamesPerTeam/2)?"✅ Complete":"⚠️ Incomplete"})]}),(0,s.jsx)("div",{className:"mt-4 flex items-center gap-3",children:q?(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium rounded-lg",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4"}),"\uD83C\uDFAF All Weeks Optimized"]})}):(0,s.jsxs)(s.Fragment,{children:[q?(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium rounded-lg",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4"}),"\uD83C\uDFAF All Weeks Optimized"]}):(0,s.jsxs)("button",{onClick:handleOptimizeSchedule,disabled:G,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,s.jsx)(j.Z,{className:"w-4 h-4"}),G?"Optimizing...":"Optimize Week ".concat(H)]}),B&&(0,s.jsx)("div",{className:"flex items-center gap-3",children:ea&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[X?(0,s.jsx)("button",{disabled:!0,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-gray-300 font-medium rounded-lg cursor-not-allowed transition-all duration-200 shadow-lg",children:"Implemented"}):(0,s.jsxs)("button",{onClick:()=>{if(ea.schedule){let e=ea.schedule.map(e=>{let t="";if(e.start&&"string"==typeof e.start){if(e.start.includes("T"))t=e.start.split("T")[0];else{let a=new Date(e.start);isNaN(a.getTime())||(t=a.toISOString().split("T")[0])}}let a=new Date(e.start),s=new Date(e.end),r=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),l=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),findTeamName=e=>{let t=x.find(t=>t.name===e);if(t)return t.name;let a=e.replace(/^(Team |b)/,""),s=x.find(e=>e.name===a||e.name==="b".concat(a)||e.name==="Team ".concat(a));return s?s.name:(console.warn("⚠️ Could not find team name for ID: ".concat(e)),e)},n=findTeamName(e.home),o=findTeamName(e.away);return console.log("\uD83D\uDD27 Date/Time processing:",{originalStart:e.start,extractedDate:t,formattedStart:r,formattedEnd:l}),console.log("\uD83D\uDD27 Team name conversion: ".concat(e.home," → ").concat(n,", ").concat(e.away," → ").concat(o)),{Date:t,Start:r,End:l,Rink:e.rink||"Unknown",Division:e.div||"Unknown",HomeTeam:n,AwayTeam:o}});if(e=sortScheduleChronologically(e),console.log("\uD83D\uDD27 Applying optimized schedule:",{originalCount:I.length,newCount:e.length,sampleOriginal:I[0],sampleNew:e[0]}),0===e.length){console.error("❌ Converted schedule is empty!"),E("Failed to convert optimized schedule");return}if(!e[0].Date||!e[0].Start){console.error("❌ Converted schedule has missing fields:",e[0]),E("Converted schedule has invalid format");return}if(console.log("✅ Schedule conversion successful, updating state..."),M(e),F("✅ Schedule updated with optimization results!"),console.log("\uD83D\uDD0D New schedule structure:",{totalGames:e.length,sampleGames:e.slice(0,3),teamNames:Array.from(new Set([...e.map(e=>e.HomeTeam),...e.map(e=>e.AwayTeam)]))}),Q(!0),V.length>0&&!V.includes(H-1)){let e=[...V,H-1];J(e),e.length>=$&&(Y(!0),console.log("\uD83C\uDFAF All weeks have been optimized!"))}if(H>=$+1)Y(!0),console.log("\uD83C\uDFAF Reached last week. All weeks complete!");else{let e=H+1;W(e),console.log("\uD83C\uDFAF Changes implemented. Moving to Week ".concat(e))}}else console.error("❌ No schedule data found in optimization results:",{hasSchedule:!!ea.schedule,scheduleType:typeof ea.schedule,isArray:Array.isArray(ea.schedule),availableKeys:Object.keys(ea)}),E("No schedule data found in optimization results")},className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:["Implement ",B.improvements," changes"]}),(0,s.jsx)("button",{onClick:()=>{el(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:"View Changes"})]})})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("h4",{className:"text-md font-medium text-gray-300",children:"Games per Team:"})}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:x.map(e=>{let t=I.filter(t=>{let a=t.HomeTeam||"",s=t.AwayTeam||"";if(a===e.name||s===e.name)return!0;if("Tin South"===e.division&&e.name.startsWith("b")){let t=e.name.replace("b","");if(a===t||s===t)return!0}if(e.name.startsWith("Team ")){let t=e.name.replace("Team ","");if(a===t||s===t)return!0}return!1}).length,a=t===g.gamesPerTeam;return 0===t?console.log("\uD83D\uDD0D Team ".concat(e.name," (").concat(e.division,") - No games found. Sample schedule entries:"),I.slice(0,3).map(e=>({home:e.HomeTeam,away:e.AwayTeam}))):t>g.gamesPerTeam&&console.log("⚠️ Team ".concat(e.name," (").concat(e.division,") - Found ").concat(t," games (expected ").concat(g.gamesPerTeam,"). This suggests double-counting.")),(0,s.jsxs)("div",{className:"bg-gray-700 rounded p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-300",children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["-",e.division]})]}),(0,s.jsx)("span",{className:"text-xs px-1 py-0.5 rounded ".concat(a?"bg-green-900/20 text-green-400":"bg-yellow-900/20 text-yellow-400"),children:a?"✓":"!"})]}),(0,s.jsxs)("div",{className:"text-lg font-bold text-blue-400 cursor-pointer hover:text-blue-300 transition-colors",onClick:()=>handleTeamClick(e.name),title:"Click to view ".concat(e.name,"'s schedule"),children:[t,"/",g.gamesPerTeam]})]},e.id)})})]})]}),I.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Generated Schedule"}),P&&(0,s.jsxs)("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm font-medium flex items-center gap-1 transition-colors",children:[(0,s.jsx)(N.Z,{className:"w-4 h-4"}),"Download Full Schedule"]})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,s.jsx)("th",{className:"text-left py-2 px-3 text-gray-400",children:"#"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Date"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Start"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Rink"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Division"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Home Team"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Away Team"})]})}),(0,s.jsx)("tbody",{children:I.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-700",children:[(0,s.jsx)("td",{className:"py-2 px-3 text-gray-400 font-mono",children:t+1}),(0,s.jsx)("td",{className:"py-2 px-3",children:e.Date}),(0,s.jsx)("td",{className:"py-2 px-3",children:e.Start}),(0,s.jsx)("td",{className:"py-2 px-3",children:e.Rink}),(0,s.jsx)("td",{className:"py-2 px-3",children:e.Division}),(0,s.jsx)("td",{className:"py-2 px-3 font-medium",children:e.HomeTeam}),(0,s.jsx)("td",{className:"py-2 px-3 font-medium",children:e.AwayTeam})]},t))})]})}),I.length>0&&(0,s.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-300 mb-2",children:"Export Schedule"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Download your schedule in CSV or Excel format for external use"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("button",{onClick:()=>exportToCSV(),className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[(0,s.jsx)(N.Z,{className:"w-4 h-4"}),"Export CSV"]}),(0,s.jsxs)("button",{onClick:()=>exportToExcel(),className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[(0,s.jsx)(N.Z,{className:"w-4 h-4"}),"Export Excel"]})]})]})})]}),R&&L&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onKeyDown:e=>{if("ArrowLeft"===e.key){let e=x.findIndex(e=>e.name===L),t=e>0?e-1:x.length-1;z(x[t].name)}else if("ArrowRight"===e.key){let e=x.findIndex(e=>e.name===L),t=e<x.length-1?e+1:0;z(x[t].name)}else"Escape"===e.key&&closeTeamSchedule()},tabIndex:0,children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>{let e=x.findIndex(e=>e.name===L),t=e>0?e-1:x.length-1;z(x[t].name)},className:"text-gray-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-gray-700",title:"Previous Team",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("h3",{className:"text-xl font-semibold text-white",children:[L,"'s Schedule",(0,s.jsxs)("span",{className:"text-sm text-gray-400 ml-2",children:["(",x.findIndex(e=>e.name===L)+1," of ",x.length,")"]})]}),(0,s.jsx)("button",{onClick:()=>{let e=x.findIndex(e=>e.name===L),t=e<x.length-1?e+1:0;z(x[t].name)},className:"text-gray-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-gray-700",title:"Next Team",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,s.jsx)("button",{onClick:closeTeamSchedule,className:"text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)(y.Z,{className:"w-6 h-6"})})]}),(0,s.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:(()=>{let e=I.filter(e=>e.HomeTeam===L||e.AwayTeam===L).sort((e,t)=>new Date(e.Date).getTime()-new Date(t.Date).getTime());return 0===e.length?(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsxs)("p",{className:"text-gray-400",children:["No games scheduled for ",L]})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400 mb-2",children:"EML Distribution:"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Early:"}),(0,s.jsx)("div",{className:"text-lg font-bold text-yellow-400",children:e.filter(e=>"Early"===getEMLCategory(e.Start)).length})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Mid:"}),(0,s.jsx)("div",{className:"text-lg font-bold text-orange-400",children:e.filter(e=>"Mid"===getEMLCategory(e.Start)).length})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Late:"}),(0,s.jsx)("div",{className:"text-lg font-bold text-red-400",children:e.filter(e=>"Late"===getEMLCategory(e.Start)).length})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Avg Days:"}),(0,s.jsx)("div",{className:"text-lg font-bold text-blue-400",children:(()=>{if(e.length<=1)return"—";let t=0,a=0;for(let s=1;s<e.length;s++){let r=new Date(e[s-1].Date),l=new Date(e[s].Date),n=l.getTime()-r.getTime(),o=Math.ceil(n/864e5);o>0&&(t+=o,a++)}return 0===a?"—":(t/e.length).toFixed(1)})()})]})]}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Debug EML values: ",(()=>{var e,t;let a=(null===(e=g.eml)||void 0===e?void 0:e.earlyStart)||"22:01",s=(null===(t=g.eml)||void 0===t?void 0:t.midStart)||"22:31",formatTime=e=>{let t=e.match(/^(\d{1,2}):(\d{2})$/);if(!t)return e;let a=parseInt(t[1]),s=t[2],r=a>=12?"PM":"AM";return a>12&&(a-=12),0===a&&(a=12),"".concat(a,":").concat(s," ").concat(r)};return"Thresholds (START times): Early < ".concat(formatTime(a),", Mid < ").concat(formatTime(s))})()]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-300",children:"Game Details:"}),e.map((t,a)=>{let r=null;if(a>0){let s=new Date(e[a-1].Date),l=new Date(t.Date),n=l.getTime()-s.getTime();r=Math.ceil(n/864e5)}let l=t.HomeTeam===L?t.AwayTeam:t.HomeTeam,n=e.slice(0,a),o=n.some(e=>{let t=e.HomeTeam===L?e.AwayTeam:e.HomeTeam;return t===l});return(0,s.jsx)("div",{className:"bg-gray-700 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsxs)("span",{className:"text-gray-400 w-8",children:["#",a+1]}),(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(t.HomeTeam===L?"bg-green-900/20 text-green-400":"bg-red-900/20 text-red-400"),children:t.HomeTeam===L?"HOME":"AWAY"}),(0,s.jsx)("span",{className:"text-gray-300 font-medium",children:t.HomeTeam===L?t.AwayTeam:t.HomeTeam}),o&&(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-900/20 text-purple-400 border border-purple-500/30",children:"2nd"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-gray-300",children:[(0,s.jsx)("span",{className:"w-24 text-xs",children:t.Date}),(0,s.jsx)("span",{className:"w-20 whitespace-nowrap",children:t.Start||"Unknown"}),(0,s.jsx)("span",{className:"w-24",children:t.Rink}),(0,s.jsx)("span",{className:"font-medium w-16 ".concat(0===r?"text-red-400":"text-blue-400"),children:null!==r?"+".concat(r,"d"):"—"})]})]})},a)})]})]})})()})]})}),er&&ea&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Optimization Results"}),(0,s.jsx)("button",{onClick:()=>el(!1),className:"text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)(y.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-300 mb-3",children:"Summary"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Total Changes"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:ea.improvement||0})]}),ea.score_before&&ea.score_after&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Division A Score"}),(0,s.jsxs)("div",{className:"text-lg font-bold text-green-400",children:[(null===(t=ea.score_before.a)||void 0===t?void 0:t.toFixed(2))||"N/A"," → ",(null===(l=ea.score_after.a)||void 0===l?void 0:l.toFixed(2))||"N/A"]})]}),(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Division B Score"}),(0,s.jsxs)("div",{className:"text-lg font-bold text-green-400",children:[(null===(n=ea.score_before.b)||void 0===n?void 0:n.toFixed(2))||"N/A"," → ",(null===(o=ea.score_after.b)||void 0===o?void 0:o.toFixed(2))||"N/A"]})]})]})]})]}),ea.swaps&&ea.swaps.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("h4",{className:"text-lg font-medium text-gray-300 mb-3",children:["Proposed Swaps (",ea.swaps.length," changes)"]}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-3",children:"Each entry shows the optimization phase, matchup details, date, time, and rink information."}),(0,s.jsx)("div",{className:"space-y-2",children:ea.swaps.filter(e=>!(e.phase&&e.phase.includes("Phase 0"))&&"cleared"!==e.division).map((e,t)=>{let a=null,r="text-gray-400",l="bg-gray-700";return e.phase?e.phase.includes("Phase 1")||e.phase.includes("Late Game")?(a="Late Game Consistency",r="text-blue-400",l="bg-blue-900/20 border border-blue-800"):e.phase.includes("Phase 2")&&!e.phase.includes("Conflict Resolution")?(a="Days Since Last Game",r="text-green-400",l="bg-green-900/20 border border-green-800"):e.phase.includes("Conflict Resolution")&&(a="Conflict Resolution",r="text-orange-400",l="bg-orange-900/20 border border-orange-800"):e.was_late&&(a="Late Game Consistency",r="text-blue-400",l="bg-blue-900/20 border border-blue-800"),(0,s.jsx)("div",{className:"".concat(l," rounded-lg p-3"),children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[a&&(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)("span",{className:"text-xs font-medium px-2 py-1 rounded-full ".concat(r," bg-opacity-20"),children:a})}),(0,s.jsxs)("div",{className:"flex items-center",children:[void 0!==e.game_id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-blue-400 font-medium",children:["Game ",e.game_id]}),(0,s.jsx)("span",{className:"text-gray-400 mx-2",children:"•"})]}),e.division&&"cleared"!==e.division&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-purple-400 font-medium",children:e.division.toUpperCase()}),(0,s.jsx)("span",{className:"text-gray-400 mx-2",children:"•"})]}),e.original_home&&e.original_away&&e.new_home&&e.new_away?(0,s.jsxs)("span",{className:"text-gray-300",children:[(0,s.jsx)("span",{className:"text-red-400",children:e.original_home})," vs ",(0,s.jsx)("span",{className:"text-blue-400",children:e.original_away}),(0,s.jsx)("span",{className:"text-gray-400 mx-2",children:"→"}),(0,s.jsx)("span",{className:"text-green-400",children:e.new_home})," vs ",(0,s.jsx)("span",{className:"text-yellow-400",children:e.new_away})]}):e.note?(0,s.jsx)("span",{className:"text-gray-300",children:e.note}):e.after&&e.after.includes(" vs ")?(0,s.jsx)("span",{className:"text-gray-300",children:e.after.replace(/\([^)]+\)/g,"").trim()}):(0,s.jsx)("span",{className:"text-gray-300",children:"Team assignment change"})]}),e.original_home&&e.original_away&&e.new_home&&e.new_away&&(0,s.jsxs)("div",{className:"text-sm text-gray-400 mt-2",children:[(0,s.jsx)("span",{className:"text-red-400",children:"Before:"})," ",e.original_home," (home) vs ",e.original_away," (away)",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-green-400",children:"After:"})," ",e.new_home," (home) vs ",e.new_away," (away)"]}),(e.date||e.rink||e.time)&&(0,s.jsx)("div",{className:"text-sm text-gray-400 mt-2",children:e.date&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-cyan-400",children:"\uD83D\uDCC5"}),(0,s.jsx)("span",{className:"text-gray-300",children:new Date(e.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})}),e.time&&(0,s.jsx)("span",{className:"text-gray-400 mx-2",children:"•"}),e.time&&(0,s.jsx)("span",{className:"text-gray-300",children:new Date(e.time).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}),e.rink&&(0,s.jsx)("span",{className:"text-gray-400 mx-2",children:"•"}),e.rink&&(0,s.jsxs)("span",{className:"text-gray-300",children:[(0,s.jsx)("span",{className:"text-cyan-400",children:"\uD83C\uDFD2"})," ",e.rink]})]})})]})})},t)})})]}),ea.buckets&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-300 mb-3",children:"EML Distribution Analysis"}),Object.entries(ea.buckets).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("h5",{className:"text-md font-medium text-gray-400 mb-2",children:["Division ",t.toUpperCase()]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,s.jsx)("th",{className:"text-left py-2 px-3 text-gray-400",children:"Team"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"E"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"M"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"L"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Target E"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Target M"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Target L"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"ΔE"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"ΔM"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"ΔL"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"B2B"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Long Gaps"}),(0,s.jsx)("th",{className:"text-center py-2 px-3 text-gray-400",children:"Avg Gap"})]})}),(0,s.jsx)("tbody",{children:a.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-700",children:[(0,s.jsx)("td",{className:"py-2 px-3 text-gray-300 font-medium",children:e.Team}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-yellow-400",children:e.E}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-orange-400",children:e.M}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-red-400",children:e.L}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Target E"]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Target M"]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Target L"]}),(0,s.jsxs)("td",{className:"py-2 px-3 text-center ".concat(e.ΔE>0?"text-red-400":e.ΔE<0?"text-green-400":"text-gray-400"),children:[e.ΔE>0?"+":"",e.ΔE]}),(0,s.jsxs)("td",{className:"py-2 px-3 text-center ".concat(e.ΔM>0?"text-red-400":e.ΔM<0?"text-green-400":"text-gray-400"),children:[e.ΔM>0?"+":"",e.ΔM]}),(0,s.jsxs)("td",{className:"py-2 px-3 text-center ".concat(e.ΔL>0?"text-red-400":e.ΔL<0?"text-green-400":"text-gray-400"),children:[e.ΔL>0?"+":"",e.ΔL]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Back-to-backs"]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Long gaps (>=10d)"]}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Avg gap (d)"]})]},t))})]})})]},t)})]})]})]})})]})}var w=a(6245),S=a(6654),T=a(6141),k=a(6418);k.Ry({timezone:k.Z_().default("America/Chicago"),noBackToBack:k.O7().default(!0),subDivisionCrossover:k.O7().default(!1),noInterdivision:k.O7().default(!0),minRestDays:k.Rx().int().min(0).default(3),maxGapDays:k.Rx().int().min(1).default(12),idealGapDays:k.Rx().int().min(3).max(14).default(7),eml:k.Ry({earlyStart:k.Z_().default("22:01"),midStart:k.Z_().default("22:31")}),gamesPerTeam:k.Rx().int().min(1).default(12),weekdayBalance:k.O7().default(!0),varianceMinimization:k.O7().default(!0),homeAwayBalance:k.O7().default(!0),holidayAwareness:k.O7().default(!0),weights:k.Ry({gapBias:k.Rx().min(0).max(10).default(1),idleUrgency:k.Rx().min(0).max(10).default(8),emlBalance:k.Rx().min(0).max(10).default(5),weekRotation:k.Rx().min(0).max(10).default(4),weekdayBalance:k.Rx().min(0).max(10).default(.5),homeAway:k.Rx().min(0).max(10).default(.5)}),seed:k.Rx().int().default(42)});let C={timezone:"America/Chicago",noBackToBack:!0,subDivisionCrossover:!1,noInterdivision:!0,minRestDays:3,maxGapDays:12,idealGapDays:7,eml:{earlyStart:"22:01",midStart:"22:31"},gamesPerTeam:12,weekdayBalance:!0,varianceMinimization:!0,homeAwayBalance:!0,holidayAwareness:!0,weights:{gapBias:1,idleUrgency:8,emlBalance:5,weekRotation:4,weekdayBalance:.5,homeAway:.5},seed:42};a(5231),a(470);var E=a(1162),A=(0,E.$)("dd2c70a84aa89ba8ed3da2899c406cd967ab70da"),F=(0,E.$)("11210b27565981870a32b24fd672ec96cf203436");function ParametersTab(e){let{emlThresholds:t,setEmlThresholds:a,amountOfGames:l,setAmountOfGames:n,params:c,setParams:d}=e,[m,u]=(0,r.useState)(!1),[g,x]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=localStorage.getItem("scheduler_params_draft");if(e)try{let t=JSON.parse(e);d(t),a(t.eml),n(t.gamesPerTeam),A(t);return}catch(e){}loadSavedParams()},[]),(0,r.useEffect)(()=>{let e={...c,eml:t,gamesPerTeam:l};(JSON.stringify(c.eml)!==JSON.stringify(t)||c.gamesPerTeam!==l)&&d(e)},[t,l]),(0,r.useEffect)(()=>{try{localStorage.setItem("scheduler_params_draft",JSON.stringify(c))}catch(e){}return f.current&&clearTimeout(f.current),f.current=setTimeout(async()=>{try{await A(c)}catch(e){console.error("Auto-save failed:",e)}},800),()=>{f.current&&clearTimeout(f.current)}},[c]);let loadSavedParams=async()=>{try{let e=await F();if(e.success&&e.data){let t=e.data.params||C;d(t),a(t.eml),n(t.gamesPerTeam)}else d(C),a(C.eml),n(C.gamesPerTeam)}catch(e){console.error("Error loading parameters:",e),d(C),a(C.eml),n(C.gamesPerTeam)}},handleSave=async()=>{u(!0),p("");try{let e=await A(c);e.success?(x("Parameters saved successfully!"),setTimeout(()=>x(""),3e3)):p("Failed to save parameters")}catch(e){p("Failed to save parameters"),console.error("Save error:",e)}finally{u(!1)}},updateParam=(e,t)=>{d({...c,[e]:t})},updateEmlParam=(e,t)=>{let s={...c,eml:{...c.eml,[e]:t}};d(s),a(s.eml)};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(o.Z,{className:"w-6 h-6"}),"Scheduling Parameters"]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)("button",{onClick:handleSave,disabled:m,className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-600 px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[(0,s.jsx)(w.Z,{className:"w-4 h-4"}),m?"Saving...":"Save Settings"]})})]}),g&&(0,s.jsx)("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4 text-green-400",children:g}),h&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 text-red-400",children:h}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(S.Z,{className:"w-5 h-5"}),"Amount of Games"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Number of Games per Team"}),(0,s.jsx)("input",{type:"number",min:"1",step:"1",value:c.gamesPerTeam,onChange:e=>{let t=parseInt(e.target.value)||1;updateParam("gamesPerTeam",t),n(t)},className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Total number of games each team will play in the season"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(T.Z,{className:"w-5 h-5"}),"Early / Mid / Late"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Early Start Time (Early games start before this time)"}),(0,s.jsx)("input",{type:"time",value:c.eml.earlyStart,onChange:e=>updateEmlParam("earlyStart",e.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:'Games starting before this time are considered "Early"'})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mid Start Time (Mid games start before this time)"}),(0,s.jsx)("input",{type:"time",value:c.eml.midStart,onChange:e=>updateEmlParam("midStart",e.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:'Games starting before this time are considered "Mid"'})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[(0,s.jsx)(i.Z,{className:"w-5 h-5"}),"Rules"]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-red-400 mb-4 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Hard Constraints"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83D\uDEAB No Back-to-Back Games"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Teams can't play each other twice in a row"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.noBackToBack,onChange:e=>updateParam("noBackToBack",e.target.checked),className:"w-5 h-5 text-red-600 bg-gray-600 border-gray-500 rounded focus:ring-red-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83D\uDD00 Sub Division Crossover"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Allows teams from different sub-divisions to play against each other"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.subDivisionCrossover,onChange:e=>updateParam("subDivisionCrossover",e.target.checked),className:"w-5 h-5 text-red-600 bg-gray-600 border-gray-500 rounded focus:ring-red-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83D\uDEAB No Inter-Division Games"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Prevents teams from different divisions from playing each other"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.noInterdivision,onChange:e=>updateParam("noInterdivision",e.target.checked),className:"w-5 h-5 text-red-600 bg-gray-600 border-gray-500 rounded focus:ring-red-500"})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-700 rounded-lg",children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83C\uDFAF Target/Ideal Gap (~7)"}),(0,s.jsx)("div",{className:"text-sm text-gray-400 mb-3",children:"Tries to keep cadence around 1 game/week; soft objective"}),(0,s.jsx)("input",{type:"number",min:"3",max:"14",value:c.idealGapDays,onChange:e=>updateParam("idealGapDays",parseInt(e.target.value)||7),className:"w-24 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-400 ml-2",children:"days"})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-700 rounded-lg",children:[(0,s.jsx)("div",{className:"font-medium",children:"⏰ Min Rest Days"}),(0,s.jsx)("div",{className:"text-sm text-gray-400 mb-3",children:"A team must have at least X days off between games"}),(0,s.jsx)("input",{type:"number",min:"0",value:c.minRestDays,onChange:e=>updateParam("minRestDays",parseInt(e.target.value)||0),className:"w-24 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-400 ml-2",children:"days"})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-700 rounded-lg",children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83D\uDCC5 Max Idle Gap"}),(0,s.jsx)("div",{className:"text-sm text-gray-400 mb-3",children:"No team should go more than Y days without a game"}),(0,s.jsx)("input",{type:"number",min:"1",value:c.maxGapDays,onChange:e=>updateParam("maxGapDays",parseInt(e.target.value)||1),className:"w-24 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-400 ml-2",children:"days"})]})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-orange-400 mb-4 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Balance Goals"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"⚖️ Balance Home and Away"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Ensures teams have balanced home/away game distribution"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.homeAwayBalance,onChange:e=>updateParam("homeAwayBalance",e.target.checked),className:"w-5 h-5 text-orange-600 bg-gray-600 border-gray-500 rounded focus:ring-orange-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83D\uDCCA Variance Minimization"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Reduces variance in game gaps across all teams"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.varianceMinimization,onChange:e=>updateParam("varianceMinimization",e.target.checked),className:"w-5 h-5 text-orange-600 bg-gray-600 border-gray-500 rounded focus:ring-orange-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83D\uDCC5 Weekday Balance"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Balances games across different days of the week"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.weekdayBalance,onChange:e=>updateParam("weekdayBalance",e.target.checked),className:"w-5 h-5 text-orange-600 bg-gray-600 border-gray-500 rounded focus:ring-orange-500"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-green-400 mb-4 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Enhancements"]}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"\uD83C\uDF84 Holiday Awareness"}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Avoids scheduling games on major holidays"})]}),(0,s.jsx)("input",{type:"checkbox",checked:c.holidayAwareness,onChange:e=>updateParam("holidayAwareness",e.target.checked),className:"w-5 h-5 text-green-600 bg-gray-600 border-gray-500 rounded focus:ring-green-500"})]})})]})]})]})}function Home(){let[e,t]=(0,r.useState)("import"),[a,c]=(0,r.useState)(null),[d,m]=(0,r.useState)([]),[u,g]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[p,f]=(0,r.useState)(()=>{{let e=localStorage.getItem("schedulerParams");if(e)return JSON.parse(e)}return C}),[y,b]=(0,r.useState)(()=>{{let e=localStorage.getItem("emlThresholds");if(e)return JSON.parse(e)}return{earlyStart:"22:01",midStart:"22:31"}});(0,r.useEffect)(()=>{console.log("\uD83D\uDD0D Main page params.eml:",p.eml),console.log("\uD83D\uDD0D Main page emlThresholds:",y),p.eml&&(p.eml.earlyStart!==y.earlyStart||p.eml.midStart!==y.midStart)&&(console.log("\uD83D\uDD04 Syncing emlThresholds with params.eml"),b({earlyStart:p.eml.earlyStart,midStart:p.eml.midStart}))},[p.eml]);let[v,D]=(0,r.useState)(()=>{{let e=localStorage.getItem("amountOfGames");if(e)return parseInt(e)}return 12}),j=[{id:"import",label:"Import",icon:l.Z},{id:"teams",label:"Teams",icon:n.Z},{id:"parameters",label:"Parameters",icon:o.Z},{id:"schedule",label:"Schedule",icon:i.Z}];return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white",children:[(0,s.jsx)("header",{className:"border-b border-gray-800",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"flex items-center justify-between h-16",children:(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("h1",{className:"text-xl font-bold",children:"League Scheduler"})})})})})}),(0,s.jsx)("div",{className:"border-b border-gray-800",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("nav",{className:"flex space-x-8",children:j.map(a=>{let r=a.icon;return(0,s.jsxs)("button",{onClick:()=>t(a.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ".concat(e===a.id?"border-red-500 text-red-500":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"),children:[(0,s.jsx)(r,{className:"w-4 h-4"}),a.label]},a.id)})})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["import"===e&&(0,s.jsx)(ImportTab,{uploadedFile:a,setUploadedFile:c,slots:d,setSlots:m,emlThresholds:y}),"teams"===e&&(0,s.jsx)(TeamsTab,{}),"schedule"===e&&(0,s.jsx)(ScheduleTab,{slots:d,teams:[],divisions:[],params:{...p,eml:y,gamesPerTeam:v}}),"parameters"===e&&(0,s.jsx)(ParametersTab,{emlThresholds:y,setEmlThresholds:e=>{b(e),localStorage.setItem("emlThresholds",JSON.stringify(e))},amountOfGames:v,setAmountOfGames:e=>{D(e),localStorage.setItem("amountOfGames",e.toString())},params:p,setParams:e=>{f(e),localStorage.setItem("schedulerParams",JSON.stringify(e))}})]})]})}}},function(e){e.O(0,[425,380,971,472,744],function(){return e(e.s=5979)}),_N_E=e.O()}]);