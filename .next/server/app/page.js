(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},4577:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},4487:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>g,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=a(7096),r=a(6132),l=a(7284),n=a.n(l),i=a(2564),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(t,o);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3982)),"/Users/egengarella/Scheduler/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,5345)),"/Users/egengarella/Scheduler/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/egengarella/Scheduler/app/page.tsx"],m="/page",g={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8143:(e,t,a)=>{let s={dd2c70a84aa89ba8ed3da2899c406cd967ab70da:()=>Promise.resolve().then(a.bind(a,1650)).then(e=>e.saveParamsAction),"11210b27565981870a32b24fd672ec96cf203436":()=>Promise.resolve().then(a.bind(a,1650)).then(e=>e.getLatestParamsAction)};async function endpoint(e,...t){let a=await s[e]();return a.apply(null,t)}e.exports={dd2c70a84aa89ba8ed3da2899c406cd967ab70da:endpoint.bind(null,"dd2c70a84aa89ba8ed3da2899c406cd967ab70da"),"11210b27565981870a32b24fd672ec96cf203436":endpoint.bind(null,"11210b27565981870a32b24fd672ec96cf203436")}},5787:(e,t,a)=>{Promise.resolve().then(a.bind(a,2386))},2386:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Home});var s=a(784),r=a(9885),l=a(6315),n=a(1438),i=a(5987),o=a(9763),d=a(9546),c=a(4678),m=a(9458),g=a(2032),u=a(1057),x=a(7560);let h="00000000-0000-0000-0000-000000000001",getSupabaseClient=()=>null;function ImportTab({uploadedFile:e,setUploadedFile:t,slots:a,setSlots:n,emlThresholds:i}){let[o,p]=(0,r.useState)(!1),[y,f]=(0,r.useState)(null),[b,j]=(0,r.useState)(a),[v,N]=(0,r.useState)([]),[D,w]=(0,r.useState)(!1);console.log("\uD83D\uDD0D ImportTab received emlThresholds:",i),console.log("\uD83D\uDD0D emlThresholds.earlyStart:",i?.earlyStart),console.log("\uD83D\uDD0D emlThresholds.midStart:",i?.midStart),(0,r.useEffect)(()=>{if(console.log("\uD83D\uDE80 ImportTab mounted, checking if CSV data exists..."),console.log("\uD83D\uDD0D Current excelData length:",b.length),console.log("\uD83D\uDD0D Current slots prop length:",a.length),a.length>0){console.log("\uD83D\uDCCA Using slots data from props:",a.length,"slots"),j(a),N(["Type","Event Start","Event End","Resource"]),t(null);return}0===b.length?(console.log("\uD83D\uDCCA No CSV data found, loading from Supabase..."),loadFromSupabase()):console.log("\uD83D\uDCCA CSV data already exists, skipping Supabase load")},[a.length,b.length]);let loadFromSupabase=async()=>{if(console.log("\uD83D\uDD04 Loading data from Supabase..."),!getSupabaseClient()){console.log("‚ùå Supabase not available"),console.warn("Supabase client not available during data load");return}try{let{data:e,error:a}=await getSupabaseClient().from("slots").select("*").eq("league_id",h).order("event_start");if(a){console.error("‚ùå Error loading slots:",a),f("Failed to load slots from database");return}if(e&&e.length>0){console.log("‚úÖ Loaded",e.length,"slots from Supabase"),console.log("\uD83D\uDD0D Processing slotsData:",e.length,"slots"),console.log("\uD83D\uDD0D First slot example:",e[0]);let a=e.map(e=>{let t="",a="",s="";try{let s=new Date(e.event_start);if(!isNaN(s.getTime())){let e=new Date(s.getTime()+6e4*s.getTimezoneOffset()),r=(e.getMonth()+1).toString().padStart(2,"0"),l=e.getDate().toString().padStart(2,"0"),n=e.getFullYear().toString().slice(-2);t=`${r}/${l}/${n}`;let i=e.getHours(),o=e.getMinutes().toString().padStart(2,"0");a=`${i%12||12}:${o} ${i>=12?"PM":"AM"}`}}catch(e){console.error("Error parsing event_start:",e)}try{let t=new Date(e.event_end);if(!isNaN(t.getTime())){let e=new Date(t.getTime()+6e4*t.getTimezoneOffset()),a=e.getHours(),r=e.getMinutes().toString().padStart(2,"0");s=`${a%12||12}:${r} ${a>=12?"PM":"AM"}`}}catch(e){console.error("Error parsing event_end:",e)}return[t,a,s,e.resource]}),s=a.sort((e,t)=>{let a=e[0],s=t[0],r=e[1],l=t[1],parseDate=e=>{if(!e||"string"!=typeof e)return new Date(0);let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return new Date(0)},parseTime=e=>{if(!e||"string"!=typeof e)return 0;let t=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!t)return 0;let a=parseInt(t[1]),s=parseInt(t[2]),r=t[3];return"PM"===r&&12!==a&&(a+=12),"AM"===r&&12===a&&(a=0),60*a+s},n=parseDate(a),i=parseDate(s);if(n.getTime()!==i.getTime())return n.getTime()-i.getTime();let o=parseTime(r),d=parseTime(l);return o-d});j(s),n(s),t(null),N(["Type","Event Start","Event End","Resource"]),f(null),console.log("‚úÖ Data loaded from Supabase successfully - UI updated"),console.log("\uD83D\uDCCA Current data count:",a.length,"rows")}else console.log("‚ö†Ô∏è No slots found in Supabase"),showNoDataMessage()}catch(e){console.error("‚ùå Error loading from Supabase:",e),f("Failed to load data from database")}},showNoDataMessage=()=>{j([]),n([]),t(null),N([]),f("No current data. Please upload a file to get started.")},saveToSupabase=async(e,t,a)=>{if(!getSupabaseClient()){console.log("‚ùå Supabase not available"),f("Database connection not available");return}try{console.log("\uD83D\uDDD1Ô∏è Clearing ALL existing data from Supabase...");let{error:e}=await getSupabaseClient().from("slots").delete().eq("league_id",h);if(e)throw Error(`Failed to delete existing slots: ${e.message}`);console.log("‚úÖ Cleared ALL existing data"),console.log("\uD83D\uDCCA Sorting",t.length,"slots by date and time...");let a=[...t].sort((e,t)=>{let parseDateForSort=e=>{if(!e)return new Date(0);let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return new Date(e)},parseTimeForSort=e=>{if(!e)return 0;let t=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!t)return 0;let a=parseInt(t[1]),s=parseInt(t[2]),r=t[3];return"PM"===r&&12!==a&&(a+=12),"AM"===r&&12===a&&(a=0),60*a+s},a=parseDateForSort(e[0]||""),s=parseDateForSort(t[0]||"");if(a.getTime()!==s.getTime())return a.getTime()-s.getTime();let r=parseTimeForSort(e[1]||""),l=parseTimeForSort(t[1]||"");return r-l});console.log("\uD83D\uDCCA Converting and inserting",a.length,"sorted slots...");let s=a.map((e,t)=>{let a=e[0]||"",s=e[1]||"",r=e[2]||"",l=e[3]||"",parseDate=e=>{if(!e)return null;let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=parseInt(t[2]);return new Date(s<100?2e3+s:s,e,a)}return null},parseDateTime=(e,t)=>{let a=parseDate(e);if(!a||!t)return null;let s=t.match(/(\d+):(\d+)\s*(AM|PM)/);if(!s)return null;let r=parseInt(s[1]),l=parseInt(s[2]),n=s[3];"PM"===n&&12!==r&&(r+=12),"AM"===n&&12===r&&(r=0);let i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),r,l,0,0),o=new Date(i.getTime()-6e4*i.getTimezoneOffset());return o.toISOString()},n=parseDateTime(a,s),i=parseDateTime(a,r);return{league_id:h,type:"game",event_start:n,event_end:i,resource:l}}).filter(e=>e.event_start&&e.event_end);console.log("\uD83D\uDCCA Inserting",s.length,"valid slots...");let{error:r}=await getSupabaseClient().from("slots").insert(s);if(r)throw Error(`Failed to insert slots: ${r.message}`);console.log("‚úÖ Successfully saved",s.length,"slots to Supabase"),await loadFromSupabase()}catch(e){console.error("‚ùå Error saving to Supabase:",e),f(`Failed to save data: ${e instanceof Error?e.message:"Unknown error"}`)}},handleFileUpload=async e=>{let a=e.target.files?.[0];if(a){console.log("File selected:",a.name),p(!0),f(null),t(a);try{let e=await readExcelFile(a);if(console.log("Raw Excel data:",e),0===e.length)throw Error("Excel file is empty");let t=e[0],s=e.slice(1),r=["Event Start","Event End"],l=t.indexOf("Type"),n=t.indexOf("Event Start"),convertExcelDate=e=>{let t;if(console.log(`Processing value: ${e} (type: ${typeof e})`),e instanceof Date)t=e,console.log(`Value is already a Date: ${t}`);else if("number"!=typeof e&&("string"!=typeof e||isNaN(Number(e))))console.log(`Trying to parse as date string: ${e}`),t=new Date(e),console.log(`Parsed date: ${t}`);else{let a=Number(e);console.log(`Converting Excel serial number: ${a}`),t=new Date((a-25569)*864e5),console.log(`Converted to date: ${t}`)}if(isNaN(t.getTime()))return console.log(`Invalid date, returning original value: ${e}`),String(e);let a=t.getHours(),s=t.getMinutes(),r=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),n=t.getFullYear().toString().slice(-2),i=s.toString().padStart(2,"0"),o=`${r}/${l}/${n} ${a%12||12}:${i} ${a>=12?"PM":"AM"}`;return console.log(`Date and time result: ${o}`),o},i=s.map(e=>e.map((e,a)=>{let s=t[a];if(a===l){if("number"==typeof e||"string"==typeof e&&!isNaN(Number(e))){let t=new Date((Number(e)-25569)*864e5),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0"),r=t.getFullYear().toString().slice(-2);return`${a}/${s}/${r}`}return String(e)}return r.includes(s)?convertExcelDate(e):String(e)}));i.sort((e,t)=>{let a=e[l],s=t[l],r=e[n],i=t[n],parseDate=e=>{if(!e||"string"!=typeof e)return new Date(0);let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return new Date(0)},parseTime=e=>{if(!e||"string"!=typeof e)return 0;let t=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!t)return 0;let a=parseInt(t[1]),s=parseInt(t[2]),r=t[3];return"PM"===r&&12!==a&&(a+=12),"AM"===r&&12===a&&(a=0),60*a+s},o=parseDate(a),d=parseDate(s);if(o.getTime()!==d.getTime())return o.getTime()-d.getTime();let c=parseTime(r),m=parseTime(i);return c-m}),await saveToSupabase(a.name,i,t),await loadFromSupabase(),console.log("‚úÖ CSV saved to Supabase, now using Supabase data for display")}catch(e){console.error("Error processing file:",e),f(e instanceof Error?e.message:"Failed to process file")}finally{p(!1)}}},readExcelFile=e=>new Promise((t,a)=>{let s=new FileReader;s.onload=e=>{try{console.log("File read successfully, processing...");let a=new Uint8Array(e.target?.result),s=x.read(a,{type:"array"});console.log("Workbook sheets:",s.SheetNames);let r=s.SheetNames[0],l=s.Sheets[r],n=x.utils.sheet_to_json(l,{header:1});console.log("Excel data converted to JSON:",n),t(n)}catch(e){console.error("Error reading Excel file:",e),a(Error("Failed to read Excel file"))}},s.onerror=e=>{console.error("FileReader error:",e),a(Error("Failed to read file"))},s.readAsArrayBuffer(e)});return(0,s.jsxs)("div",{className:"space-y-6",children:[s.jsx("div",{children:(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(l.Z,{className:"w-6 h-6"}),"Import Data"]})}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("button",{onClick:()=>w(!D),className:"w-full flex items-center justify-between text-left",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(d.Z,{className:"w-5 h-5"}),"Expected File Format"]}),D?s.jsx(c.Z,{className:"w-5 h-5 text-gray-400"}):s.jsx(m.Z,{className:"w-5 h-5 text-gray-400"})]}),D&&(0,s.jsxs)("div",{className:"text-sm text-gray-300 space-y-3 mt-4",children:[s.jsx("p",{children:"Your Excel file should have the following structure:"}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full border border-gray-600 rounded",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-700",children:[s.jsx("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Date"}),s.jsx("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Event Start"}),s.jsx("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Event End"}),s.jsx("th",{className:"px-4 py-2 text-left border-b border-gray-600",children:"Resource"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"9/6/25"}),s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"9:00 PM"}),s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"10:20 PM"}),s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"GPI - Rink 4"})]}),(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"9/6/25"}),s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"10:15 PM"}),s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"11:35 PM"}),s.jsx("td",{className:"px-4 py-2 border-b border-gray-600",children:"GPI - Rink 2"})]}),(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"px-4 py-2",children:"9/9/25"}),s.jsx("td",{className:"px-4 py-2",children:"9:35 PM"}),s.jsx("td",{className:"px-4 py-2",children:"10:55 PM"}),s.jsx("td",{className:"px-4 py-2",children:"GPI - Rink 3"})]})]})]})})]})]}),s.jsx("div",{className:"flex justify-center",children:(0,s.jsxs)("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:handleFileUpload,className:"hidden",disabled:o}),(0,s.jsxs)("div",{className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-600 px-6 py-3 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[s.jsx(l.Z,{className:"w-5 h-5"}),o?"Processing...":"Upload CSV"]})]})}),e&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[s.jsx(g.Z,{className:"w-5 h-5"}),(0,s.jsxs)("span",{children:["File uploaded: ",e.name]})]}),y&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-400",children:[s.jsx(u.Z,{className:"w-5 h-5"}),(0,s.jsxs)("span",{children:["Error loading file: ",y]})]}),0===b.length&&!o&&s.jsx("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:(0,s.jsxs)("div",{className:"text-gray-400 mb-4",children:[s.jsx(d.Z,{className:"w-16 h-16 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Current Data"}),s.jsx("p",{className:"text-sm",children:"Upload a file to get started with your league scheduling."})]})}),b.length>0&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:b.length}),s.jsx("div",{className:"text-sm text-gray-400",children:"Total Games"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:(()=>{if(0===b.length)return"N/A";let e=b[0][0];if(e&&e.includes("T"))try{let t=new Date(e);return t.toLocaleDateString()}catch(e){return"N/A"}if(e&&"string"==typeof e){let t=e.split("/");if(3===t.length){let e=parseInt(t[0]),a=parseInt(t[1]),s=2e3+parseInt(t[2]);return`${e}/${a}/${s}`}}return"N/A"})()}),s.jsx("div",{className:"text-sm text-gray-400",children:"Start Date"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:(()=>{if(0===b.length)return"N/A";let e=b[b.length-1][0];if(e&&e.includes("T"))try{let t=new Date(e);return t.toLocaleDateString()}catch(e){return"N/A"}if(e&&"string"==typeof e){let t=e.split("/");if(3===t.length){let e=parseInt(t[0]),a=parseInt(t[1]),s=2e3+parseInt(t[2]);return`${e}/${a}/${s}`}}return"N/A"})()}),s.jsx("div",{className:"text-sm text-gray-400",children:"End Date"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:(()=>{if(0===b.length)return"N/A";let e=b[0][0],t=b[b.length-1][0],parseDate=e=>{if(!e||"string"!=typeof e)return null;let t=e.split("/");if(3===t.length){let e=parseInt(t[0])-1,a=parseInt(t[1]),s=2e3+parseInt(t[2]);return new Date(s,e,a)}return null},a=parseDate(e),s=parseDate(t);if(a&&s){let e=s.getTime()-a.getTime();return Math.max(1,Math.ceil(Math.ceil(e/864e5)/7))}return a?1:"N/A"})()}),s.jsx("div",{className:"text-sm text-gray-400",children:"Weeks"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:(()=>{let getEMLCategory=e=>{if(!i||!i.earlyStart||!i.midStart)return console.warn("‚ö†Ô∏è emlThresholds not properly initialized:",i),"Unknown";let t=i.earlyStart||"22:01",a=i.midStart||"22:31",s=e.includes(" ")?e.split(" ").slice(-2).join(" "):e;console.log("\uD83D\uDD0D Original timeStr:",e,"Extracted timeOnly:",s);let r=s.match(/(\d+):(\d+)\s*(AM|PM)/);if(!r)return console.warn("‚ö†Ô∏è Failed to parse time:",e,"timeOnly:",s),"Unknown";let l=parseInt(r[1]),n=parseInt(r[2]),o=r[3];"PM"===o&&12!==l&&(l+=12),"AM"===o&&12===l&&(l=0);let d=60*l+n;console.log("\uD83D\uDD0D Converted to 24-hour:",{hours:l,minutes:n,gameMinutes:d});let c=0,m=0,g=t.match(/^(\d{1,2}):(\d{2})$/),u=a.match(/^(\d{1,2}):(\d{2})$/);return g&&u?(console.log("\uD83D\uDD0D EML thresholds (24-hour):",{earlyStart:t,midStart:a,earlyMinutesTotal:c=60*parseInt(g[1])+parseInt(g[2]),midMinutesTotal:m=60*parseInt(u[1])+parseInt(u[2])}),d<c)?"Early":d>=c&&d<m?"Mid":"Late":(console.warn("‚ö†Ô∏è EML thresholds not in expected 24-hour format:",{earlyStart:t,midStart:a}),"Unknown")},e=b.filter(e=>{let t=e[1]||"";return"Early"===getEMLCategory(t)}).length,t=b.filter(e=>{let t=e[1]||"";return"Mid"===getEMLCategory(t)}).length,a=b.filter(e=>{let t=e[1]||"";return"Late"===getEMLCategory(t)}).length;return`${e} / ${t} / ${a}`})()}),s.jsx("div",{className:"text-sm text-gray-400",children:"E / M / L"})]})]}),s.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full",children:[s.jsx("thead",{className:"bg-gray-700",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"DATE"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"EVENT START"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"EVENT END"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"RESOURCE"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"E/M/L"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700",children:b.map((e,t)=>{let formatTime=e=>{if(!e)return"N/A";if(e.includes("T"))try{let t=new Date(e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(e){}return e},a=e[1]||"",r=(e=>{if(!i||!i.earlyStart||!i.midStart)return console.warn("‚ö†Ô∏è emlThresholds not properly initialized:",i),"Unknown";let t=i.earlyStart||"22:01",a=i.midStart||"22:31",s=e.includes(" ")?e.split(" ").slice(-2).join(" "):e;console.log("\uD83D\uDD0D Original timeStr:",e,"Extracted timeOnly:",s);let r=s.match(/(\d+):(\d+)\s*(AM|PM)/);if(!r)return console.warn("‚ö†Ô∏è Failed to parse time:",e,"timeOnly:",s),"Unknown";let l=parseInt(r[1]),n=parseInt(r[2]),o=r[3];"PM"===o&&12!==l&&(l+=12),"AM"===o&&12===l&&(l=0);let d=60*l+n;console.log("\uD83D\uDD0D Converted to 24-hour:",{hours:l,minutes:n,gameMinutes:d});let c=0,m=0,g=t.match(/^(\d{1,2}):(\d{2})$/),u=a.match(/^(\d{1,2}):(\d{2})$/);return g&&u?(console.log("\uD83D\uDD0D EML thresholds (24-hour):",{earlyStart:t,midStart:a,earlyMinutesTotal:c=60*parseInt(g[1])+parseInt(g[2]),midMinutesTotal:m=60*parseInt(u[1])+parseInt(u[2])}),d<c)?"Early":d>=c&&d<m?"Mid":"Late":(console.warn("‚ö†Ô∏è EML thresholds not in expected 24-hour format:",{earlyStart:t,midStart:a}),"Unknown")})(a);return(0,s.jsxs)("tr",{className:"hover:bg-gray-700",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(e=>{if(!e)return"N/A";if(e.includes("T"))try{let t=new Date(e);return t.toLocaleDateString()}catch(t){return e}if("string"==typeof e){let t=e.split("/");if(3===t.length){let e=parseInt(t[0]),a=parseInt(t[1]),s=2e3+parseInt(t[2]);return`${e}/${a}/${s}`}}return e})(e[0])}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:formatTime(e[1])}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:formatTime(e[2])}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e[3]||""}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${"Early"===r?"bg-green-600":"Mid"===r?"bg-yellow-600":"bg-red-600"}`,children:r})})]},t)})})]})})})]})]})}var p=a(6206),y=a(2385),f=a(1672);function TeamsTab(){let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[u,x]=(0,r.useState)(!1),[h,b]=(0,r.useState)(null),[j,v]=(0,r.useState)(null),[N,D]=(0,r.useState)("");(0,r.useEffect)(()=>{loadTeamsFromSupabase()},[]);let loadTeamsFromSupabase=async()=>{console.log("‚ùå Supabase not available"),b("Database connection not available")},addTeamToSupabase=async(e,t)=>{console.log("‚ùå Supabase not available"),b("Database connection not available")},removeTeamFromSupabase=async e=>{console.log("‚ùå Supabase not available"),b("Database connection not available")},addDivision=()=>{i.trim()&&(addTeamToSupabase(i.trim(),"Team 1"),o(""))},addTeam=e=>{let t=w[e]||[],a=t.map(e=>{let t=e.name.match(/Team (\d+)/);return t?parseInt(t[1]):0}),s=a.length>0?Math.max(...a)+1:1,r=`Team ${s}`;addTeamToSupabase(e,r)},removeTeam=e=>{removeTeamFromSupabase(e)},removeDivision=async e=>{console.log("‚ùå Supabase not available"),b("Database connection not available")},updateTeamName=async(e,t)=>{console.log("‚ùå Supabase not available"),b("Database connection not available")},startEditing=e=>{v(e.id),D(e.name)},saveTeamName=()=>{j&&N.trim()&&(updateTeamName(j,N.trim()),v(null),D(""))},cancelEditing=()=>{v(null),D("")},w=a.reduce((t,a)=>{let s=e.filter(e=>e.division_id===a.id),r=s.sort((e,t)=>{let a=e.name.match(/Team (\d+)/),s=t.name.match(/Team (\d+)/);return a&&s?parseInt(a[1])-parseInt(s[1]):e.name.localeCompare(t.name)});return t[a.name]=r,console.log(`üìä Division "${a.name}": ${r.length} teams`,r.map(e=>e.name)),t},{});return console.log("\uD83D\uDD0D Total teams in state:",e.length),console.log("\uD83D\uDD0D Teams by division:",w),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(n.Z,{className:"w-6 h-6"}),"Teams & Divisions"]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400 mt-2",children:["Total teams: ",e.length," | Total divisions: ",a.length]})]}),h&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-400 bg-red-900/20 border border-red-800 rounded-lg p-4",children:[s.jsx(p.Z,{className:"w-5 h-5"}),s.jsx("span",{children:h})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(y.Z,{className:"w-5 h-5"}),"Add Division"]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[s.jsx("input",{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"Enter division name...",className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500",onKeyPress:e=>"Enter"===e.key&&addDivision()}),s.jsx("button",{onClick:addDivision,disabled:!i.trim(),className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-600 px-6 py-2 rounded-lg font-medium transition-colors",children:"Add Division"})]})]}),e.length>0?s.jsx("div",{className:"space-y-4",children:a.map(e=>(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(n.Z,{className:"w-5 h-5"}),e.name]}),s.jsx("button",{onClick:()=>removeDivision(e.name),className:"text-red-400 hover:text-red-300 transition-colors",title:"Remove entire division",children:s.jsx(p.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-400",children:[w[e.name]?.length||0," team",1!==(w[e.name]?.length||0)?"s":""]}),(0,s.jsxs)("button",{onClick:()=>addTeam(e.name),className:"bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-sm font-medium flex items-center gap-1 transition-colors",children:[s.jsx(y.Z,{className:"w-3 h-3"}),"Add Team"]})]})]}),s.jsx("div",{className:"space-y-2",children:(w[e.name]||[]).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-700 rounded-lg px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx(f.Z,{className:"w-4 h-4 text-gray-400"}),j===e.id?(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("input",{type:"text",value:N,onChange:e=>D(e.target.value),className:"flex-1 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500",onKeyPress:e=>{"Enter"===e.key&&saveTeamName(),"Escape"===e.key&&cancelEditing()},autoFocus:!0}),s.jsx("button",{onClick:saveTeamName,className:"text-green-400 hover:text-green-300 transition-colors",title:"Save",children:"‚úì"}),s.jsx("button",{onClick:cancelEditing,className:"text-gray-400 hover:text-gray-300 transition-colors",title:"Cancel",children:"‚úï"})]}):s.jsx("span",{className:"cursor-pointer hover:text-gray-300 transition-colors",onClick:()=>startEditing(e),title:"Click to edit team name",children:e.name})]}),s.jsx("button",{onClick:()=>removeTeam(e.id),className:"text-red-400 hover:text-red-300 transition-colors ml-2",title:"Remove team",children:s.jsx(p.Z,{className:"w-4 h-4"})})]},e.id))})]},e.id))}):(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 text-center",children:[s.jsx(n.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-400",children:"No teams added yet."}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Add teams above to start building your league structure."})]})]})}var b=a(644),j=a(6494),v=a(8003);function ScheduleTab({slots:e,teams:t,divisions:l,params:n}){let getEMLCategory=e=>{let t=n.eml?.earlyStart||"22:01",a=n.eml?.midStart||"22:31",s=e.match(/(\d+):(\d+)\s*(AM|PM)/);if(!s)return"Unknown";let r=parseInt(s[1]),l=parseInt(s[2]),i=s[3];"PM"===i&&12!==r&&(r+=12),"AM"===i&&12===r&&(r=0);let o=60*r+l,d=0,c=0,m=t.match(/^(\d{1,2}):(\d{2})$/),g=a.match(/^(\d{1,2}):(\d{2})$/);if(m&&g)d=60*parseInt(m[1])+parseInt(m[2]),c=60*parseInt(g[1])+parseInt(g[2]);else{let e=t.match(/(\d+):(\d+)\s*(AM|PM)/),s=a.match(/(\d+):(\d+)\s*(AM|PM)/);if(!e||!s)return"Unknown";let r=parseInt(e[1]),l=parseInt(e[2]),n=e[3],i=parseInt(s[1]),o=parseInt(s[2]),m=s[3];"PM"===n&&12!==r&&(r+=12),"AM"===n&&12===r&&(r=0),"PM"===m&&12!==i&&(i+=12),"AM"===m&&12===i&&(i=0),d=60*r+l,c=60*i+o}return o<d?"Early":o>=d&&o<c?"Mid":"Late"},[i,d]=(0,r.useState)([]),[c,m]=(0,r.useState)([]),[u,x]=(0,r.useState)([]),[y,f]=(0,r.useState)(!1),[N,D]=(0,r.useState)(""),[w,S]=(0,r.useState)(""),[T,k]=(0,r.useState)([]),[E,A]=(0,r.useState)(null),[C,$]=(0,r.useState)(null),[P,M]=(0,r.useState)(!1),[_,I]=(0,r.useState)(!1),[L,F]=(0,r.useState)(null),[z,R]=(0,r.useState)(2),[G,U]=(0,r.useState)([]),[O,B]=(0,r.useState)(!1),[Z,H]=(0,r.useState)(0),[W,q]=(0,r.useState)(!1),[V,Y]=(0,r.useState)(!1),[K,J]=(0,r.useState)(null),[X,Q]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(!1),[ea,es]=(0,r.useState)(!1),[er,el]=(0,r.useState)(null),en=(0,r.useRef)(null);(0,r.useEffect)(()=>{loadTeamsAndDivisions(),loadSlots(),loadParams()},[]),(0,r.useEffect)(()=>()=>{en.current&&(clearTimeout(en.current),console.log("\uD83C\uDFAF Cleaned up auto-optimization timer on unmount"))},[]),(0,r.useEffect)(()=>{V&&!_&&z>2&&(console.log(`üéØ Auto-optimization: Starting Week ${z}`),Y(!1),handleOptimizeSchedule())},[V,_,z]),(0,r.useEffect)(()=>{T.length>0&&console.log("\uD83D\uDD04 Schedule updated - recalculating team counts:",{scheduleLength:T.length,teamNames:Array.from(new Set([...T.map(e=>e.HomeTeam),...T.map(e=>e.AwayTeam)])),sampleGames:T.slice(0,3)})},[T]);let sortScheduleChronologically=e=>[...e].sort((e,t)=>{let a=new Date(`${e.Date} ${e.Start}`),s=new Date(`${t.Date} ${t.Start}`);return a.getTime()-s.getTime()}),loadSlots=async()=>{},loadParams=async()=>{try{let e=await fetch("/api/parameters");if(e.ok){let t=await e.json();t.success&&t.data&&console.log("‚úÖ Loaded parameters from server:",t.data)}}catch(e){console.error("Error loading parameters:",e)}},handleTeamClick=e=>{$(e),M(!0)},closeTeamSchedule=()=>{M(!1),$(null)},handleOptimizeSchedule=async()=>{if(T.length){console.log(`üéØ handleOptimizeSchedule called for Week ${z}`),console.log(`üéØ Current state: currentWeek=${z}, weeksOptimized=${G.join(",")}, allWeeksComplete=${O}`),I(!0),F(null),q(!1);try{console.log("\uD83D\uDD27 Starting optimization with schedule:",T.length,"games"),console.log("\uD83D\uDD27 Using schedule in original order (scheduler already created proper blocks)");let e=Array.from(new Set(T.map(e=>e.Division)));console.log("\uD83D\uDD27 Unique divisions in schedule:",e),console.log("\uD83D\uDD27 Sample games with divisions:"),T.slice(0,10).forEach((e,t)=>{console.log(`  ${t+1}. Div: "${e.Division}" - ${e.HomeTeam} vs ${e.AwayTeam}`)});let t=[];for(let e=0;e<T.length;e+=10){let a=T.slice(e,e+10);10===a.length&&t.push(a)}if(console.log("\uD83D\uDD27 Total games:",T.length),console.log("\uD83D\uDD27 Block size:",10),console.log("\uD83D\uDD27 Found complete blocks:",t.length),0===t.length){D(`Schedule must have complete blocks of 10 games for optimization. Found ${T.length} total games.`),I(!1);return}let a=t[0];a.reduce((e,t)=>{let a=t.Division?.toLowerCase().trim();return"Tin Super"===a||a?.includes("12")?e["Tin Super"]=(e["Tin Super"]||0)+1:("Tin South"===a||a?.includes("8"))&&(e["Tin South"]=(e["Tin South"]||0)+1),e},{}),console.log("\uD83D\uDD27 Processing ALL games for optimization (not just first block)"),console.log("\uD83D\uDD27 Total games to optimize:",T.length);let s=T.map((e,t)=>{let a=new Date(e.Date+" "+e.Start),s=e.End||"22:20",r=new Date(e.Date+" "+s),l="unknown";if(e.Division){let t=e.Division.toLowerCase().trim();l="tin super"===t||t.includes("12")?"Tin Super":"tin south"===t||t.includes("8")?"Tin South":"unknown"}let extractTeamNumber=e=>{let t=e.match(/(\d+)$/);return t?t[1]:e},formatLocalTime=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0");return`${t}-${a}-${s}T${r}:${l}:00.000`};return{id:t+1,start:formatLocalTime(a),end:formatLocalTime(r),rink:e.Rink||"Unknown",div:l,home:extractTeamNumber(e.HomeTeam),away:extractTeamNumber(e.AwayTeam)}});console.log("\uD83D\uDD27 Prepared schedule data:",s.slice(0,3)),console.log("\uD83D\uDD27 Total games to optimize:",s.length),console.log("\uD83D\uDD27 Division counts:",s.reduce((e,t)=>(e[t.div]=(e[t.div]||0)+1,e),{})),console.log("\uD83D\uDD27 Sample game structure:",{sampleGame:s[0],sampleGameKeys:Object.keys(s[0]||{}),sampleGameValues:Object.values(s[0]||{})}),console.log("\uD83D\uDD27 Game order check:"),s.forEach((e,t)=>{console.log(`  Game ${t+1}: ${e.start} (ID: ${e.id}) - ${e.home} vs ${e.away} (${e.div})`)});let r=s.some(e=>"unknown"===e.div);console.log("\uD83D\uDD27 Data validation:",{hasUnknownDiv:r}),console.log("\uD83D\uDD27 Sample games with readable times:"),s.slice(0,10).forEach((e,t)=>{let a=new Date(e.start),s=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});console.log(`  Game ${t+1}: ${e.start} ‚Üí ${s} - ${e.home} vs ${e.away} (${e.div})`)});let l=s.filter(e=>{let t=new Date(e.start);return t.getHours()>=22&&t.getMinutes()>=31});if(console.log(`üîß Late games found: ${l.length} out of ${s.length} total games`),l.length>0&&(console.log("\uD83D\uDD27 Late games:"),l.slice(0,5).forEach((e,t)=>{let a=new Date(e.start),s=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});console.log(`  Late Game ${t+1}: ${e.start} ‚Üí ${s} - ${e.home} vs ${e.away} (${e.div})`)})),r){D("Cannot optimize schedule with unknown divisions. Please check division assignments."),I(!1);return}let n={schedule:s,blockSize:10,blockRecipe:{"Tin Super":6,"Tin South":4},divisionSizes:{"Tin Super":12,"Tin South":8},earlyStart:"10:01 PM",midStart:"10:31 PM",target_week:z,defaultGameMinutes:80,weights:{w_eml:1,w_runs:.2,w_rest:.6},wGlobal:2,wRolling:1.2,wRepeat:1,wDispersion:.6,wLateFairness:1,globalSlack:1,rollingSlack:0,maxPasses:3,dryRun:!1,optimize_days_since:!0,force_full_validation:!0};console.log(`üéØ Auto-optimization API request for Week ${z}:`,n),console.log(`üéØ Ensuring three-phase optimization with full validation...`);let o=await fetch("/api/optimize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(console.log("\uD83D\uDD27 API response status:",o.status),!o.ok){let e=await o.text();throw console.error("\uD83D\uDD27 API error response:",e),Error(`API error: ${o.status} - ${e}`)}let d=await o.json();if(console.log("\uD83D\uDD27 Optimization result:",d),console.log(`üéØ API result optimization tracking:`,{weeks_optimized:d.weeks_optimized,all_weeks_complete:d.all_weeks_complete,total_optimizable_weeks:d.total_optimizable_weeks}),d.weeks_optimized&&U(d.weeks_optimized),void 0!==d.all_weeks_complete&&B(d.all_weeks_complete),d.total_optimizable_weeks?(console.log(`üéØ Setting totalOptimizableWeeks to: ${d.total_optimizable_weeks}`),H(d.total_optimizable_weeks)):console.log(`üéØ WARNING: No total_optimizable_weeks in API result!`),d.swaps&&d.swaps.length>0){if(F({improvements:d.swaps.length}),J(d),d.swaps.length===i.length){if(console.log(`üéØ Perfect solution! ${d.swaps.length} changes = ${i.length} teams`),console.log(`üéØ Auto-optimization DISABLED for testing. Week ${z} complete.`),console.log(`üéØ Please manually move to next week to test if this fixes the 0-day gap issue.`),d.swaps&&d.swaps.length>0&&(console.log(`üéØ DEBUG: Setting optimization results for manual use: ${d.swaps.length} swaps`),J(d),F({improvements:d.swaps.length})),d.schedule){console.log(`üéØ Auto-optimization: Updating schedule for Week ${z}`);let e=d.schedule.map(e=>{let t=e.start?.split("T")[0]||"",a=new Date(e.start),s=new Date(e.end);return{Date:t,Start:a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),End:s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),Rink:e.rink||"Unknown",Division:e.div||"Unknown",HomeTeam:e.home||"Unknown",AwayTeam:e.away||"Unknown"}});k(e),console.log(`üéØ Schedule updated successfully for Week ${z}`),console.log(`üéØ Optimization results preserved for manual implementation`)}console.log(`üéØ Auto-optimization DISABLED for testing. Week ${z} complete.`),console.log(`üéØ Please manually move to next week to test if this fixes the 0-day gap issue.`),d.swaps&&d.swaps.length>0&&(console.log(`üéØ DEBUG: Setting optimization results for manual use: ${d.swaps.length} swaps`),J(d),F({improvements:d.swaps.length}))}else console.log(`üéØ Week ${z} optimization complete. Waiting for user to implement changes.`)}else F({improvements:0}),console.log(`üéØ Week ${z} optimization complete (no changes). Waiting for user to implement changes.`)}catch(e){console.error("‚ùå Optimization error:",e),D("Optimization failed: "+e.message)}finally{I(!1)}}},loadTeamsAndDivisions=async()=>{},exportToCSV=()=>{if(!T.length)return;let e=["Game #,Date,Start Time,End Time,Rink,Division,Home Team,Away Team",...T.map((e,t)=>[t+1,e.Date,e.Start,e.End||"",e.Rink,e.Division,e.HomeTeam,e.AwayTeam].join(","))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(t);a.setAttribute("href",s),a.setAttribute("download",`league-schedule-${new Date().toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},exportToExcel=()=>{if(!T.length)return;let e=T.map((e,t)=>({"Game #":t+1,Date:e.Date,"Start Time":e.Start,"End Time":e.End||"",Rink:e.Rink,Division:e.Division,"Home Team":e.HomeTeam,"Away Team":e.AwayTeam}));Promise.resolve().then(a.bind(a,7560)).then(t=>{let a=t.utils.book_new(),s=t.utils.json_to_sheet(e);s["!cols"]=[{wch:8},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:15},{wch:15}],t.utils.book_append_sheet(a,s,"League Schedule");let r=t.write(a,{bookType:"xlsx",type:"array"}),l=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a"),i=URL.createObjectURL(l);n.setAttribute("href",i),n.setAttribute("download",`league-schedule-${new Date().toISOString().split("T")[0]}.xlsx`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}).catch(e=>{console.error("Error exporting to Excel:",e),alert("Excel export failed. Falling back to CSV export."),exportToCSV()})},generateSchedule=async()=>{f(!0),D(""),S("");try{console.log("\uD83D\uDD0D DEBUG: Current state before request:"),console.log("  - Slots count:",u.length),console.log("  - Teams count:",i.length),console.log("  - Divisions count:",c.length),console.log("  - Params:",n),console.log("  - Sample slot:",u[0]),console.log("  - Sample team:",i[0]),console.log("Sending request with:",{leagueId:h,slotsCount:u.length,teamsCount:i.length,divisionsCount:c.length,params:n});let e=await fetch("/api/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:h,params:n,slots:u,teams:i,divisions:c})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to generate schedule");if(console.log("Schedule generation result:",t),console.log("Schedule data:",t.schedule),t.schedule&&Array.isArray(t.schedule)){let e=t.schedule.filter(e=>e&&"object"==typeof e&&e.Date&&e.HomeTeam&&e.AwayTeam);e=sortScheduleChronologically(e),console.log("Valid schedule entries:",e.length),console.log("\uD83D\uDCC5 Schedule sorted chronologically from",e[0]?.Date,"to",e[e.length-1]?.Date),k(e);let a=Math.ceil(e.length/10),s=a-1;H(s),console.log(`üìä Schedule has ${a} weeks, ${s} can be optimized`),U([]),B(!1),R(2)}else console.log("No valid schedule data received"),k([]),H(0),U([]),B(!1);S("Schedule generated successfully!")}catch(e){console.error("Schedule generation error:",e),D(e instanceof Error?e.message:"Failed to generate schedule")}finally{f(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[s.jsx("div",{children:(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(o.Z,{className:"w-6 h-6"}),"Schedule Generation"]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Data Imported"}),s.jsx("p",{className:"text-2xl font-bold text-green-400",children:u.length}),s.jsx("p",{className:"text-sm text-gray-400",children:"Available time slots"})]}),s.jsx(g.Z,{className:"w-8 h-8 text-green-500"})]})}),s.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Teams Configured"}),s.jsx("p",{className:"text-2xl font-bold text-green-400",children:i.length}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:["Teams across ",c.length," divisions"]})]}),s.jsx(g.Z,{className:"w-8 h-8 text-green-500"})]})}),s.jsx("div",{className:"bg-gray-800 rounded-lg p-6",children:s.jsx("button",{onClick:generateSchedule,disabled:y||0===u.length||0===i.length,className:"w-full h-full bg-green-600 hover:bg-green-700 disabled:bg-gray-600 px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",children:y?(0,s.jsxs)(s.Fragment,{children:[s.jsx(b.Z,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(o.Z,{className:"w-5 h-5"}),"Generate Schedule"]})})})]}),N&&s.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 text-red-400",children:N}),w&&s.jsx("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4 text-green-400",children:w}),T.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Game Count Summary"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-400",children:"Games Generated:"}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-green-400",children:[T.length,"/",Math.round(i.length*n.gamesPerTeam/2)]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-400",children:"Status:"}),s.jsx("span",{className:`text-sm font-medium px-2 py-1 rounded ${T.length===Math.round(i.length*n.gamesPerTeam/2)?"bg-green-900/20 text-green-400 border border-green-800":"bg-yellow-900/20 text-yellow-400 border border-yellow-800"}`,children:T.length===Math.round(i.length*n.gamesPerTeam/2)?"‚úÖ Complete":"‚ö†Ô∏è Incomplete"})]}),s.jsx("div",{className:"mt-4 flex items-center gap-3",children:O?s.jsx("div",{className:"flex items-center gap-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium rounded-lg",children:[s.jsx(g.Z,{className:"w-4 h-4"}),"\uD83C\uDFAF All Weeks Optimized"]})}):(0,s.jsxs)(s.Fragment,{children:[O?(0,s.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium rounded-lg",children:[s.jsx(g.Z,{className:"w-4 h-4"}),"\uD83C\uDFAF All Weeks Optimized"]}):(0,s.jsxs)("button",{onClick:handleOptimizeSchedule,disabled:_,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:[s.jsx(j.Z,{className:"w-4 h-4"}),_?"Optimizing...":`Optimize Week ${z}`]}),L&&s.jsx("div",{className:"flex items-center gap-3",children:K&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[W?s.jsx("button",{disabled:!0,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-gray-300 font-medium rounded-lg cursor-not-allowed transition-all duration-200 shadow-lg",children:"Implemented"}):(0,s.jsxs)("button",{onClick:()=>{if(K.schedule){let e=K.schedule.map(e=>{let t="";if(e.start&&"string"==typeof e.start){if(e.start.includes("T"))t=e.start.split("T")[0];else{let a=new Date(e.start);isNaN(a.getTime())||(t=a.toISOString().split("T")[0])}}let a=new Date(e.start),s=new Date(e.end),r=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),l=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),findTeamName=e=>{let t=i.find(t=>t.name===e);if(t)return t.name;let a=e.replace(/^(Team |b)/,""),s=i.find(e=>e.name===a||e.name===`b${a}`||e.name===`Team ${a}`);return s?s.name:(console.warn(`‚ö†Ô∏è Could not find team name for ID: ${e}`),e)},n=findTeamName(e.home),o=findTeamName(e.away);return console.log(`üîß Date/Time processing:`,{originalStart:e.start,extractedDate:t,formattedStart:r,formattedEnd:l}),console.log(`üîß Team name conversion: ${e.home} ‚Üí ${n}, ${e.away} ‚Üí ${o}`),{Date:t,Start:r,End:l,Rink:e.rink||"Unknown",Division:e.div||"Unknown",HomeTeam:n,AwayTeam:o}});if(e=sortScheduleChronologically(e),console.log("\uD83D\uDD27 Applying optimized schedule:",{originalCount:T.length,newCount:e.length,sampleOriginal:T[0],sampleNew:e[0]}),0===e.length){console.error("‚ùå Converted schedule is empty!"),D("Failed to convert optimized schedule");return}if(!e[0].Date||!e[0].Start){console.error("‚ùå Converted schedule has missing fields:",e[0]),D("Converted schedule has invalid format");return}if(console.log("‚úÖ Schedule conversion successful, updating state..."),k(e),S("‚úÖ Schedule updated with optimization results!"),console.log("\uD83D\uDD0D New schedule structure:",{totalGames:e.length,sampleGames:e.slice(0,3),teamNames:Array.from(new Set([...e.map(e=>e.HomeTeam),...e.map(e=>e.AwayTeam)]))}),q(!0),G.length>0&&!G.includes(z-1)){let e=[...G,z-1];U(e),e.length>=Z&&(B(!0),console.log("\uD83C\uDFAF All weeks have been optimized!"))}if(z>=Z+1)B(!0),console.log("\uD83C\uDFAF Reached last week. All weeks complete!");else{let e=z+1;R(e),console.log(`üéØ Changes implemented. Moving to Week ${e}`)}}else console.error("‚ùå No schedule data found in optimization results:",{hasSchedule:!!K.schedule,scheduleType:typeof K.schedule,isArray:Array.isArray(K.schedule),availableKeys:Object.keys(K)}),D("No schedule data found in optimization results")},className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:["Implement ",L.improvements," changes"]}),s.jsx("button",{onClick:()=>{Q(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:"View Changes"})]})})]})})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"mb-3",children:s.jsx("h4",{className:"text-md font-medium text-gray-300",children:"Games per Team:"})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:i.map(e=>{let t=T.filter(t=>{let a=t.HomeTeam||"",s=t.AwayTeam||"";if(a===e.name||s===e.name)return!0;if("Tin South"===e.division&&e.name.startsWith("b")){let t=e.name.replace("b","");if(a===t||s===t)return!0}if(e.name.startsWith("Team ")){let t=e.name.replace("Team ","");if(a===t||s===t)return!0}return!1}).length,a=t===n.gamesPerTeam;return 0===t?console.log(`üîç Team ${e.name} (${e.division}) - No games found. Sample schedule entries:`,T.slice(0,3).map(e=>({home:e.HomeTeam,away:e.AwayTeam}))):t>n.gamesPerTeam&&console.log(`‚ö†Ô∏è Team ${e.name} (${e.division}) - Found ${t} games (expected ${n.gamesPerTeam}). This suggests double-counting.`),(0,s.jsxs)("div",{className:"bg-gray-700 rounded p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-300",children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["-",e.division]})]}),s.jsx("span",{className:`text-xs px-1 py-0.5 rounded ${a?"bg-green-900/20 text-green-400":"bg-yellow-900/20 text-yellow-400"}`,children:a?"‚úì":"!"})]}),(0,s.jsxs)("div",{className:"text-lg font-bold text-blue-400 cursor-pointer hover:text-blue-300 transition-colors",onClick:()=>handleTeamClick(e.name),title:`Click to view ${e.name}'s schedule`,children:[t,"/",n.gamesPerTeam]})]},e.id)})})]})]}),T.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Generated Schedule"}),E&&(0,s.jsxs)("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:"bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm font-medium flex items-center gap-1 transition-colors",children:[s.jsx(v.Z,{className:"w-4 h-4"}),"Download Full Schedule"]})]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-700",children:[s.jsx("th",{className:"text-left py-2 px-3 text-gray-400",children:"#"}),s.jsx("th",{className:"text-left py-2 px-3",children:"Date"}),s.jsx("th",{className:"text-left py-2 px-3",children:"Start"}),s.jsx("th",{className:"text-left py-2 px-3",children:"Rink"}),s.jsx("th",{className:"text-left py-2 px-3",children:"Division"}),s.jsx("th",{className:"text-left py-2 px-3",children:"Home Team"}),s.jsx("th",{className:"text-left py-2 px-3",children:"Away Team"})]})}),s.jsx("tbody",{children:T.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-700",children:[s.jsx("td",{className:"py-2 px-3 text-gray-400 font-mono",children:t+1}),s.jsx("td",{className:"py-2 px-3",children:e.Date}),s.jsx("td",{className:"py-2 px-3",children:e.Start}),s.jsx("td",{className:"py-2 px-3",children:e.Rink}),s.jsx("td",{className:"py-2 px-3",children:e.Division}),s.jsx("td",{className:"py-2 px-3 font-medium",children:e.HomeTeam}),s.jsx("td",{className:"py-2 px-3 font-medium",children:e.AwayTeam})]},t))})]})}),T.length>0&&s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-300 mb-2",children:"Export Schedule"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Download your schedule in CSV or Excel format for external use"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("button",{onClick:()=>exportToCSV(),className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[s.jsx(v.Z,{className:"w-4 h-4"}),"Export CSV"]}),(0,s.jsxs)("button",{onClick:()=>exportToExcel(),className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[s.jsx(v.Z,{className:"w-4 h-4"}),"Export Excel"]})]})]})})]}),P&&C&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onKeyDown:e=>{if("ArrowLeft"===e.key){let e=i.findIndex(e=>e.name===C),t=e>0?e-1:i.length-1;$(i[t].name)}else if("ArrowRight"===e.key){let e=i.findIndex(e=>e.name===C),t=e<i.length-1?e+1:0;$(i[t].name)}else"Escape"===e.key&&closeTeamSchedule()},tabIndex:0,children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>{let e=i.findIndex(e=>e.name===C),t=e>0?e-1:i.length-1;$(i[t].name)},className:"text-gray-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-gray-700",title:"Previous Team",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("h3",{className:"text-xl font-semibold text-white",children:[C,"'s Schedule",(0,s.jsxs)("span",{className:"text-sm text-gray-400 ml-2",children:["(",i.findIndex(e=>e.name===C)+1," of ",i.length,")"]})]}),s.jsx("button",{onClick:()=>{let e=i.findIndex(e=>e.name===C),t=e<i.length-1?e+1:0;$(i[t].name)},className:"text-gray-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-gray-700",title:"Next Team",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),s.jsx("button",{onClick:closeTeamSchedule,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx(p.Z,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:(()=>{let e=T.filter(e=>e.HomeTeam===C||e.AwayTeam===C).sort((e,t)=>new Date(e.Date).getTime()-new Date(t.Date).getTime());return 0===e.length?s.jsx("div",{className:"text-center py-8",children:(0,s.jsxs)("p",{className:"text-gray-400",children:["No games scheduled for ",C]})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"EML Distribution:"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Early:"}),s.jsx("div",{className:"text-lg font-bold text-yellow-400",children:e.filter(e=>"Early"===getEMLCategory(e.Start)).length})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Mid:"}),s.jsx("div",{className:"text-lg font-bold text-orange-400",children:e.filter(e=>"Mid"===getEMLCategory(e.Start)).length})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Late:"}),s.jsx("div",{className:"text-lg font-bold text-red-400",children:e.filter(e=>"Late"===getEMLCategory(e.Start)).length})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Avg Days:"}),s.jsx("div",{className:"text-lg font-bold text-blue-400",children:(()=>{if(e.length<=1)return"‚Äî";let t=0,a=0;for(let s=1;s<e.length;s++){let r=new Date(e[s-1].Date),l=new Date(e[s].Date),n=l.getTime()-r.getTime(),i=Math.ceil(n/864e5);i>0&&(t+=i,a++)}return 0===a?"‚Äî":(t/e.length).toFixed(1)})()})]})]}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Debug EML values: ",(()=>{let e=n.eml?.earlyStart||"22:01",t=n.eml?.midStart||"22:31",formatTime=e=>{let t=e.match(/^(\d{1,2}):(\d{2})$/);if(!t)return e;let a=parseInt(t[1]),s=t[2],r=a>=12?"PM":"AM";return a>12&&(a-=12),0===a&&(a=12),`${a}:${s} ${r}`};return`Thresholds (START times): Early < ${formatTime(e)}, Mid < ${formatTime(t)}`})()]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-lg font-medium text-gray-300",children:"Game Details:"}),e.map((t,a)=>{let r=null;if(a>0){let s=new Date(e[a-1].Date),l=new Date(t.Date),n=l.getTime()-s.getTime();r=Math.ceil(n/864e5)}let l=t.HomeTeam===C?t.AwayTeam:t.HomeTeam,n=e.slice(0,a),i=n.some(e=>{let t=e.HomeTeam===C?e.AwayTeam:e.HomeTeam;return t===l});return s.jsx("div",{className:"bg-gray-700 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsxs)("span",{className:"text-gray-400 w-8",children:["#",a+1]}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.HomeTeam===C?"bg-green-900/20 text-green-400":"bg-red-900/20 text-red-400"}`,children:t.HomeTeam===C?"HOME":"AWAY"}),s.jsx("span",{className:"text-gray-300 font-medium",children:t.HomeTeam===C?t.AwayTeam:t.HomeTeam}),i&&s.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-purple-900/20 text-purple-400 border border-purple-500/30",children:"2nd"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-gray-300",children:[s.jsx("span",{className:"w-24 text-xs",children:t.Date}),s.jsx("span",{className:"w-20 whitespace-nowrap",children:t.Start||"Unknown"}),s.jsx("span",{className:"w-24",children:t.Rink}),s.jsx("span",{className:`font-medium w-16 ${0===r?"text-red-400":"text-blue-400"}`,children:null!==r?`+${r}d`:"‚Äî"})]})]})},a)})]})]})})()})]})}),X&&K&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[s.jsx("h3",{className:"text-xl font-semibold text-white",children:"Optimization Results"}),s.jsx("button",{onClick:()=>Q(!1),className:"text-gray-400 hover:text-white transition-colors",children:s.jsx(p.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h4",{className:"text-lg font-medium text-gray-300 mb-3",children:"Summary"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-400",children:"Total Changes"}),s.jsx("div",{className:"text-2xl font-bold text-blue-400",children:K.improvement||0})]}),K.score_before&&K.score_after&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-400",children:"Division A Score"}),(0,s.jsxs)("div",{className:"text-lg font-bold text-green-400",children:[K.score_before.a?.toFixed(2)||"N/A"," ‚Üí ",K.score_after.a?.toFixed(2)||"N/A"]})]}),(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-400",children:"Division B Score"}),(0,s.jsxs)("div",{className:"text-lg font-bold text-green-400",children:[K.score_before.b?.toFixed(2)||"N/A"," ‚Üí ",K.score_after.b?.toFixed(2)||"N/A"]})]})]})]})]}),K.swaps&&K.swaps.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("h4",{className:"text-lg font-medium text-gray-300 mb-3",children:["Proposed Swaps (",K.swaps.length," changes)"]}),s.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Each entry shows the optimization phase, matchup details, date, time, and rink information."}),s.jsx("div",{className:"space-y-2",children:K.swaps.filter(e=>!(e.phase&&e.phase.includes("Phase 0"))&&"cleared"!==e.division).map((e,t)=>{let a=null,r="text-gray-400",l="bg-gray-700";return e.phase?e.phase.includes("Phase 1")||e.phase.includes("Late Game")?(a="Late Game Consistency",r="text-blue-400",l="bg-blue-900/20 border border-blue-800"):e.phase.includes("Phase 2")&&!e.phase.includes("Conflict Resolution")?(a="Days Since Last Game",r="text-green-400",l="bg-green-900/20 border border-green-800"):e.phase.includes("Conflict Resolution")&&(a="Conflict Resolution",r="text-orange-400",l="bg-orange-900/20 border border-orange-800"):e.was_late&&(a="Late Game Consistency",r="text-blue-400",l="bg-blue-900/20 border border-blue-800"),s.jsx("div",{className:`${l} rounded-lg p-3`,children:s.jsx("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[a&&s.jsx("div",{className:"mb-2",children:s.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${r} bg-opacity-20`,children:a})}),(0,s.jsxs)("div",{className:"flex items-center",children:[void 0!==e.game_id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-blue-400 font-medium",children:["Game ",e.game_id]}),s.jsx("span",{className:"text-gray-400 mx-2",children:"‚Ä¢"})]}),e.division&&"cleared"!==e.division&&(0,s.jsxs)(s.Fragment,{children:[s.jsx("span",{className:"text-purple-400 font-medium",children:e.division.toUpperCase()}),s.jsx("span",{className:"text-gray-400 mx-2",children:"‚Ä¢"})]}),e.original_home&&e.original_away&&e.new_home&&e.new_away?(0,s.jsxs)("span",{className:"text-gray-300",children:[s.jsx("span",{className:"text-red-400",children:e.original_home})," vs ",s.jsx("span",{className:"text-blue-400",children:e.original_away}),s.jsx("span",{className:"text-gray-400 mx-2",children:"‚Üí"}),s.jsx("span",{className:"text-green-400",children:e.new_home})," vs ",s.jsx("span",{className:"text-yellow-400",children:e.new_away})]}):e.note?s.jsx("span",{className:"text-gray-300",children:e.note}):e.after&&e.after.includes(" vs ")?s.jsx("span",{className:"text-gray-300",children:e.after.replace(/\([^)]+\)/g,"").trim()}):s.jsx("span",{className:"text-gray-300",children:"Team assignment change"})]}),e.original_home&&e.original_away&&e.new_home&&e.new_away&&(0,s.jsxs)("div",{className:"text-sm text-gray-400 mt-2",children:[s.jsx("span",{className:"text-red-400",children:"Before:"})," ",e.original_home," (home) vs ",e.original_away," (away)",s.jsx("br",{}),s.jsx("span",{className:"text-green-400",children:"After:"})," ",e.new_home," (home) vs ",e.new_away," (away)"]}),(e.date||e.rink||e.time)&&s.jsx("div",{className:"text-sm text-gray-400 mt-2",children:e.date&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-cyan-400",children:"\uD83D\uDCC5"}),s.jsx("span",{className:"text-gray-300",children:new Date(e.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})}),e.time&&s.jsx("span",{className:"text-gray-400 mx-2",children:"‚Ä¢"}),e.time&&s.jsx("span",{className:"text-gray-300",children:new Date(e.time).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}),e.rink&&s.jsx("span",{className:"text-gray-400 mx-2",children:"‚Ä¢"}),e.rink&&(0,s.jsxs)("span",{className:"text-gray-300",children:[s.jsx("span",{className:"text-cyan-400",children:"\uD83C\uDFD2"})," ",e.rink]})]})})]})})},t)})})]}),K.buckets&&(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-300 mb-3",children:"EML Distribution Analysis"}),Object.entries(K.buckets).map(([e,t])=>(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("h5",{className:"text-md font-medium text-gray-400 mb-2",children:["Division ",e.toUpperCase()]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-700",children:[s.jsx("th",{className:"text-left py-2 px-3 text-gray-400",children:"Team"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"E"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"M"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"L"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"Target E"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"Target M"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"Target L"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"ŒîE"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"ŒîM"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"ŒîL"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"B2B"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"Long Gaps"}),s.jsx("th",{className:"text-center py-2 px-3 text-gray-400",children:"Avg Gap"})]})}),s.jsx("tbody",{children:t.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-700",children:[s.jsx("td",{className:"py-2 px-3 text-gray-300 font-medium",children:e.Team}),s.jsx("td",{className:"py-2 px-3 text-center text-yellow-400",children:e.E}),s.jsx("td",{className:"py-2 px-3 text-center text-orange-400",children:e.M}),s.jsx("td",{className:"py-2 px-3 text-center text-red-400",children:e.L}),s.jsx("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Target E"]}),s.jsx("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Target M"]}),s.jsx("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Target L"]}),(0,s.jsxs)("td",{className:`py-2 px-3 text-center ${e.ŒîE>0?"text-red-400":e.ŒîE<0?"text-green-400":"text-gray-400"}`,children:[e.ŒîE>0?"+":"",e.ŒîE]}),(0,s.jsxs)("td",{className:`py-2 px-3 text-center ${e.ŒîM>0?"text-red-400":e.ŒîM<0?"text-green-400":"text-gray-400"}`,children:[e.ŒîM>0?"+":"",e.ŒîM]}),(0,s.jsxs)("td",{className:`py-2 px-3 text-center ${e.ŒîL>0?"text-red-400":e.ŒîL<0?"text-green-400":"text-gray-400"}`,children:[e.ŒîL>0?"+":"",e.ŒîL]}),s.jsx("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Back-to-backs"]}),s.jsx("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Long gaps (>=10d)"]}),s.jsx("td",{className:"py-2 px-3 text-center text-gray-400",children:e["Avg gap (d)"]})]},t))})]})})]},e))]})]})]})})]})}var N=a(2995),D=a(696),w=a(5441),S=a(7588);S.Ry({timezone:S.Z_().default("America/Chicago"),noBackToBack:S.O7().default(!0),subDivisionCrossover:S.O7().default(!1),noInterdivision:S.O7().default(!0),minRestDays:S.Rx().int().min(0).default(3),maxGapDays:S.Rx().int().min(1).default(12),idealGapDays:S.Rx().int().min(3).max(14).default(7),eml:S.Ry({earlyStart:S.Z_().default("22:01"),midStart:S.Z_().default("22:31")}),gamesPerTeam:S.Rx().int().min(1).default(12),weekdayBalance:S.O7().default(!0),varianceMinimization:S.O7().default(!0),homeAwayBalance:S.O7().default(!0),holidayAwareness:S.O7().default(!0),weights:S.Ry({gapBias:S.Rx().min(0).max(10).default(1),idleUrgency:S.Rx().min(0).max(10).default(8),emlBalance:S.Rx().min(0).max(10).default(5),weekRotation:S.Rx().min(0).max(10).default(4),weekdayBalance:S.Rx().min(0).max(10).default(.5),homeAway:S.Rx().min(0).max(10).default(.5)}),seed:S.Rx().int().default(42)});let T={timezone:"America/Chicago",noBackToBack:!0,subDivisionCrossover:!1,noInterdivision:!0,minRestDays:3,maxGapDays:12,idealGapDays:7,eml:{earlyStart:"22:01",midStart:"22:31"},gamesPerTeam:12,weekdayBalance:!0,varianceMinimization:!0,homeAwayBalance:!0,holidayAwareness:!0,weights:{gapBias:1,idleUrgency:8,emlBalance:5,weekRotation:4,weekdayBalance:.5,homeAway:.5},seed:42};a(5422),a(3009);var k=a(1324),E=(0,k.$)("dd2c70a84aa89ba8ed3da2899c406cd967ab70da"),A=(0,k.$)("11210b27565981870a32b24fd672ec96cf203436");function ParametersTab({emlThresholds:e,setEmlThresholds:t,amountOfGames:a,setAmountOfGames:l,params:n,setParams:d}){let[c,m]=(0,r.useState)(!1),[g,u]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{loadSavedParams()},[]),(0,r.useEffect)(()=>{let t={...n,eml:e,gamesPerTeam:a};(JSON.stringify(n.eml)!==JSON.stringify(e)||n.gamesPerTeam!==a)&&d(t)},[e,a]),(0,r.useEffect)(()=>(p.current&&clearTimeout(p.current),p.current=setTimeout(async()=>{try{await E(n)}catch(e){console.error("Auto-save failed:",e)}},800),()=>{p.current&&clearTimeout(p.current)}),[n]);let loadSavedParams=async()=>{try{let e=await A();if(e.success&&e.data){let a=e.data.params||T;d(a),t(a.eml),l(a.gamesPerTeam)}else d(T),t(T.eml),l(T.gamesPerTeam)}catch(e){console.error("Error loading parameters:",e),d(T),t(T.eml),l(T.gamesPerTeam)}},handleSave=async()=>{m(!0),h("");try{let e=await E(n);e.success?(u("Parameters saved successfully!"),setTimeout(()=>u(""),3e3)):h("Failed to save parameters")}catch(e){h("Failed to save parameters"),console.error("Save error:",e)}finally{m(!1)}},updateParam=(e,t)=>{d({...n,[e]:t})},updateEmlParam=(e,a)=>{let s={...n,eml:{...n.eml,[e]:a}};d(s),t(s.eml)};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(i.Z,{className:"w-6 h-6"}),"Scheduling Parameters"]}),s.jsx("div",{className:"flex gap-2",children:(0,s.jsxs)("button",{onClick:handleSave,disabled:c,className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-600 px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors",children:[s.jsx(N.Z,{className:"w-4 h-4"}),c?"Saving...":"Save Settings"]})})]}),g&&s.jsx("div",{className:"bg-green-900/20 border border-green-800 rounded-lg p-4 text-green-400",children:g}),x&&s.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 text-red-400",children:x}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(D.Z,{className:"w-5 h-5"}),"Amount of Games"]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Number of Games per Team"}),s.jsx("input",{type:"number",min:"1",step:"1",value:n.gamesPerTeam,onChange:e=>{let t=parseInt(e.target.value)||1;updateParam("gamesPerTeam",t),l(t)},className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Total number of games each team will play in the season"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(w.Z,{className:"w-5 h-5"}),"Early / Mid / Late"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Early Start Time (Early games start before this time)"}),s.jsx("input",{type:"time",value:n.eml.earlyStart,onChange:e=>updateEmlParam("earlyStart",e.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Games starting before this time are considered "Early"'})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mid Start Time (Mid games start before this time)"}),s.jsx("input",{type:"time",value:n.eml.midStart,onChange:e=>updateEmlParam("midStart",e.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Games starting before this time are considered "Mid"'})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[s.jsx(o.Z,{className:"w-5 h-5"}),"Rules"]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-red-400 mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Hard Constraints"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"\uD83D\uDEAB No Back-to-Back Games"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Teams can't play each other twice in a row"})]}),s.jsx("input",{type:"checkbox",checked:n.noBackToBack,onChange:e=>updateParam("noBackToBack",e.target.checked),className:"w-5 h-5 text-red-600 bg-gray-600 border-gray-500 rounded focus:ring-red-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"\uD83D\uDD00 Sub Division Crossover"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Allows teams from different sub-divisions to play against each other"})]}),s.jsx("input",{type:"checkbox",checked:n.subDivisionCrossover,onChange:e=>updateParam("subDivisionCrossover",e.target.checked),className:"w-5 h-5 text-red-600 bg-gray-600 border-gray-500 rounded focus:ring-red-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"\uD83D\uDEAB No Inter-Division Games"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Prevents teams from different divisions from playing each other"})]}),s.jsx("input",{type:"checkbox",checked:n.noInterdivision,onChange:e=>updateParam("noInterdivision",e.target.checked),className:"w-5 h-5 text-red-600 bg-gray-600 border-gray-500 rounded focus:ring-red-500"})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-700 rounded-lg",children:[s.jsx("div",{className:"font-medium",children:"\uD83C\uDFAF Target/Ideal Gap (~7)"}),s.jsx("div",{className:"text-sm text-gray-400 mb-3",children:"Tries to keep cadence around 1 game/week; soft objective"}),s.jsx("input",{type:"number",min:"3",max:"14",value:n.idealGapDays,onChange:e=>updateParam("idealGapDays",parseInt(e.target.value)||7),className:"w-24 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),s.jsx("span",{className:"text-sm text-gray-400 ml-2",children:"days"})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-700 rounded-lg",children:[s.jsx("div",{className:"font-medium",children:"‚è∞ Min Rest Days"}),s.jsx("div",{className:"text-sm text-gray-400 mb-3",children:"A team must have at least X days off between games"}),s.jsx("input",{type:"number",min:"0",value:n.minRestDays,onChange:e=>updateParam("minRestDays",parseInt(e.target.value)||0),className:"w-24 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),s.jsx("span",{className:"text-sm text-gray-400 ml-2",children:"days"})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-700 rounded-lg",children:[s.jsx("div",{className:"font-medium",children:"\uD83D\uDCC5 Max Idle Gap"}),s.jsx("div",{className:"text-sm text-gray-400 mb-3",children:"No team should go more than Y days without a game"}),s.jsx("input",{type:"number",min:"1",value:n.maxGapDays,onChange:e=>updateParam("maxGapDays",parseInt(e.target.value)||1),className:"w-24 bg-gray-600 border border-gray-500 rounded px-2 py-1 text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),s.jsx("span",{className:"text-sm text-gray-400 ml-2",children:"days"})]})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-orange-400 mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Balance Goals"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"‚öñÔ∏è Balance Home and Away"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Ensures teams have balanced home/away game distribution"})]}),s.jsx("input",{type:"checkbox",checked:n.homeAwayBalance,onChange:e=>updateParam("homeAwayBalance",e.target.checked),className:"w-5 h-5 text-orange-600 bg-gray-600 border-gray-500 rounded focus:ring-orange-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"\uD83D\uDCCA Variance Minimization"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Reduces variance in game gaps across all teams"})]}),s.jsx("input",{type:"checkbox",checked:n.varianceMinimization,onChange:e=>updateParam("varianceMinimization",e.target.checked),className:"w-5 h-5 text-orange-600 bg-gray-600 border-gray-500 rounded focus:ring-orange-500"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"\uD83D\uDCC5 Weekday Balance"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Balances games across different days of the week"})]}),s.jsx("input",{type:"checkbox",checked:n.weekdayBalance,onChange:e=>updateParam("weekdayBalance",e.target.checked),className:"w-5 h-5 text-orange-600 bg-gray-600 border-gray-500 rounded focus:ring-orange-500"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-green-400 mb-4 flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Enhancements"]}),s.jsx("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"font-medium",children:"\uD83C\uDF84 Holiday Awareness"}),s.jsx("div",{className:"text-sm text-gray-400",children:"Avoids scheduling games on major holidays"})]}),s.jsx("input",{type:"checkbox",checked:n.holidayAwareness,onChange:e=>updateParam("holidayAwareness",e.target.checked),className:"w-5 h-5 text-green-600 bg-gray-600 border-gray-500 rounded focus:ring-green-500"})]})})]})]})]})}function Home(){let[e,t]=(0,r.useState)("import"),[a,d]=(0,r.useState)(null),[c,m]=(0,r.useState)([]),[g,u]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[p,y]=(0,r.useState)(()=>T),[f,b]=(0,r.useState)(()=>({earlyStart:"22:01",midStart:"22:31"}));(0,r.useEffect)(()=>{console.log("\uD83D\uDD0D Main page params.eml:",p.eml),console.log("\uD83D\uDD0D Main page emlThresholds:",f),p.eml&&(p.eml.earlyStart!==f.earlyStart||p.eml.midStart!==f.midStart)&&(console.log("\uD83D\uDD04 Syncing emlThresholds with params.eml"),b({earlyStart:p.eml.earlyStart,midStart:p.eml.midStart}))},[p.eml]);let[j,v]=(0,r.useState)(()=>12),N=[{id:"import",label:"Import",icon:l.Z},{id:"teams",label:"Teams",icon:n.Z},{id:"parameters",label:"Parameters",icon:i.Z},{id:"schedule",label:"Schedule",icon:o.Z}];return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white",children:[s.jsx("header",{className:"border-b border-gray-800",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-between h-16",children:s.jsx("div",{className:"flex items-center",children:s.jsx("div",{className:"flex-shrink-0",children:s.jsx("h1",{className:"text-xl font-bold",children:"League Scheduler"})})})})})}),s.jsx("div",{className:"border-b border-gray-800",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("nav",{className:"flex space-x-8",children:N.map(a=>{let r=a.icon;return(0,s.jsxs)("button",{onClick:()=>t(a.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${e===a.id?"border-red-500 text-red-500":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:[s.jsx(r,{className:"w-4 h-4"}),a.label]},a.id)})})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["import"===e&&s.jsx(ImportTab,{uploadedFile:a,setUploadedFile:d,slots:c,setSlots:m,emlThresholds:f}),"teams"===e&&s.jsx(TeamsTab,{}),"schedule"===e&&s.jsx(ScheduleTab,{slots:c,teams:[],divisions:[],params:{...p,eml:f,gamesPerTeam:j}}),"parameters"===e&&s.jsx(ParametersTab,{emlThresholds:f,setEmlThresholds:e=>{b(e)},amountOfGames:j,setAmountOfGames:e=>{v(e)},params:p,setParams:e=>{y(e)}})]})]})}},1650:(e,t,a)=>{"use strict";a.r(t),a.d(t,{getLatestParamsAction:()=>getLatestParamsAction,saveParamsAction:()=>saveParamsAction});var s=a(8065);a(8106);var r=a(5840),l=a(5098),n=a(8116);let i=process.env.SUPABASE_SERVICE_ROLE_KEY,o=null;async function saveParamsAction(e){if(!o)throw Error("SUPABASE_SERVICE_ROLE_KEY is not configured");try{console.log("\uD83D\uDD27 Attempting to save parameters with service role..."),console.log("\uD83D\uDD27 League ID:",l.DEFAULT_LEAGUE_ID),console.log("\uD83D\uDD27 Parsed params:",JSON.stringify(e,null,2));let{data:t,error:a}=await o.from("scheduler_params").insert({league_id:l.DEFAULT_LEAGUE_ID,name:"Latest Parameters",params:e}).select().single();if(a)throw console.error("‚ùå Service role insert failed:",a),Error(`Failed to save parameters: ${a.message}`);return console.log("‚úÖ Parameters saved successfully with service role"),{success:!0,data:t}}catch(e){throw console.error("‚ùå Error saving parameters:",e),e}}async function getLatestParamsAction(){if(!o)return console.warn("SUPABASE_SERVICE_ROLE_KEY not configured, returning null"),null;try{let{data:e,error:t}=await o.from("scheduler_params").select("*").eq("league_id",l.DEFAULT_LEAGUE_ID).order("created_at",{ascending:!1}).limit(1).single();if(t)return console.error("Error fetching latest parameters:",t),null;return e?.params||null}catch(e){return console.error("Error in getLatestParamsAction:",e),null}}i&&(o=(0,r.createClient)("https://zcoupiuradompbrsebdp.supabase.co",i)),(0,n.ensureServerEntryExports)([saveParamsAction,getLatestParamsAction]),(0,s.createActionProxy)("dd2c70a84aa89ba8ed3da2899c406cd967ab70da",null,saveParamsAction),(0,s.createActionProxy)("11210b27565981870a32b24fd672ec96cf203436",null,getLatestParamsAction)},3982:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>o});var s=a(5153);let r=(0,s.createProxy)(String.raw`/Users/egengarella/Scheduler/app/page.tsx`),{__esModule:l,$$typeof:n}=r,i=r.default,o=i},5098:(e,t,a)=>{"use strict";a.d(t,{DEFAULT_LEAGUE_ID:()=>s});let s="00000000-0000-0000-0000-000000000001"}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[142,214,167,487],()=>__webpack_exec__(4487));module.exports=a})();